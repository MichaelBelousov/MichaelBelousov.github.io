"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8865],{78865:function(e,t,n){n.d(t,{Pu:function(){return l},ZP:function(){return S},Jt:function(){return P}});var a=n(159),o=n(91164),i=n(67294),r=n(3905),p=["components"],l=(i.createElement,{title:"Creating an Insights Report using iModel Data",tile:{name:"Creating an Insights Report using iModel Data",description:"This tutorial will teach you how to create an Insights Report using iModel data.",thumbnail:"",href:"/tutorials/creating-an-insights-report-using-imodel-data",durationInMinutes:45,relatedApiIds:["insights","insights/reporting"]}}),s=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)}},d=s("Introduction"),u=s("TutorialSection"),c=s("CreateSampleAppButton"),m=s("LinkButton"),h=s("NodeJsIcon"),g=s("GitIcon"),k=s("Title"),y=s("CodeBlock"),T=s("GoogleChromeIcon"),f=s("VSCodeIcon"),w=s("PostmanIcon"),N=s("Alert"),b=s("ContinueLearningSection"),I=s("TileList"),C=s("ResourceTile"),x={metadata:l};function S(e){var t=e.components,n=(0,o.Z)(e,p);return(0,r.kt)("wrapper",(0,a.Z)({},x,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(d,{skillLevel:"Basic",durationInMinutes:"45",summaryImageSrc:"",mdxType:"Introduction"},(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"The Reporting API is a tool for aggregating digital twin data from multiple sources\ninto one unified format and place. With the Reporting API, consuming your data through\nbusiness intelligence applications such as Power BI or your own custom-built\napplication is dramatically simplified."),(0,r.kt)("p",null,"This tutorial will cover all the fundamental steps to a typical workflow of creating\nan Insights Report using iModel data. We will first go through a step by step guide\non how to use the Reporting APIs to configure and generate a simple Report. We will also\nbriefly cover a small sample NodeJS application that goes through the same steps to help\nyou get started writing an application of your own to build Reports on your own iModels.")),(0,r.kt)(u,{actions:[(0,r.kt)(c,{scopes:["openid","insights:read","insights:modify"],clientName:"Creating an insights report using imodel data tutorial",mdxType:"CreateSampleAppButton"})],mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"1-set-up-your-environment"},"1. Set up your environment"),(0,r.kt)("p",null,"This tutorial expects that you have access to a registered application and have access to a project as owner/administrator or know someone who has owner/admin privileges. You can use the ",(0,r.kt)("strong",{parentName:"p"},"Register")," button to automatically create your first single page application (SPA). This will allow you to configure ",(0,r.kt)("a",{parentName:"p",href:"/apis/overview/authorization/#authorizesinglepageapplicationsspaanddesktopmobileapplicationsnative"},"Authorization Code Flow for your SPA application")," and get the correct access token."),(0,r.kt)("p",null,"Once generated, you will be shown a few lines of code under the button."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_CLIENT_ID")," - this is the unique identifier for your application. Displayed on application details page as ",(0,r.kt)("strong",{parentName:"li"},"Client ID"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_REDIRECT_URI")," - specifies where users are redirected after they have chosen whether or not to authenticate your app. Displayed on application details page as one of ",(0,r.kt)("strong",{parentName:"li"},"Redirect URIs"),". Displayed on application details page as one of ",(0,r.kt)("strong",{parentName:"li"},"Redirect URIs"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_LOGOUT_URI")," - specifies where users can be returned to after logging out. Displayed on application details page as one of ",(0,r.kt)("strong",{parentName:"li"},"Post logout redirect URIs"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_SCOPES")," - list of accesses granted to the application. Displayed on application details page as ",(0,r.kt)("strong",{parentName:"li"},"Scopes"),". Displayed on application details page as ",(0,r.kt)("strong",{parentName:"li"},"Scopes"),".")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Or optionally:")," Register and configure your application manually following instructions in ",(0,r.kt)("a",{parentName:"p",href:"/tutorials/register-and-modify-application/"},"Register and modify an Application")," tutorial.\nMake sure that your application is associated with ",(0,r.kt)("strong",{parentName:"p"},"Visualization")," and ",(0,r.kt)("strong",{parentName:"p"},"Insights")," APIs and has ",(0,r.kt)("inlineCode",{parentName:"p"},"openid insights:read insights:modify")," scopes enabled.")),(0,r.kt)("p",null,"Use of the Reporting APIs requires some iModel/Project level Permissions.\nFor these Permissions, you must be an Organization Administrator for the Organization\nthat owns a given Project or have ",(0,r.kt)("inlineCode",{parentName:"p"},"administration_manage_roles")," Permission assigned at\nthe Project level. If you do not have admin access to the Project or iModel you would\nlike to use, contact somebody who is a Project Administrator. As a Project Administrator,\nyou can use APIs described in the ",(0,r.kt)("a",{parentName:"p",href:"/tutorials/manage-project-team-members-guide/"},"Manage Project Team Members"),"\ntutorial to create a Role and update it with ",(0,r.kt)("inlineCode",{parentName:"p"},'"permissions": ["REPORTINGVIEW", "REPORTINGEDIT", "imodels_read", "imodels_write"]'),".\nOnce this is done and the Role is assigned to you, you can use any iModel inside your\nProject to finish this tutorial.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(m,{href:"https://nodejs.org",target:"_blank",title:"Node.js",icon:(0,r.kt)(h,{mdxType:"NodeJsIcon"}),mdxType:"LinkButton"}),(0,r.kt)(m,{href:"https://git-scm.com/downloads",target:"_blank",title:"Git",icon:(0,r.kt)(g,{mdxType:"GitIcon"}),mdxType:"LinkButton"}),(0,r.kt)(k,{mdxType:"Title"},"Clone our TypeScript Sample"),(0,r.kt)(y,{language:"bash",code:"git clone https://github.com/iTwin/insights-api-sample-console-app",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"11-required-materials"},"1.1 Required materials"),(0,r.kt)("h5",{id:"a-hrefhttpsnodejsorg-target_blanknodejs-v12-must-be-greater-than-1210xa"},(0,r.kt)("a",{href:"https://nodejs.org",target:"_blank"},"Node.js v12 (must be greater than 12.10.x)")),(0,r.kt)("p",null,"This tool provides the backend JavaScript runtime necessary for your computer to read and\nrender code appropriately. It also allows you to run NPM command line (required for every\niTwin project)."),(0,r.kt)("h5",{id:"a-hrefhttpsgit-scmcomdownloads-target_blankgita"},(0,r.kt)("a",{href:"https://git-scm.com/downloads",target:"_blank"},"Git")),(0,r.kt)("p",null,"This is the source code control system for the iTwin repositories."),(0,r.kt)("h5",{id:"a-hrefhttpsgithubcomitwinchanged-elements-tutorial-target_blanktutorial-repositorya"},(0,r.kt)("a",{href:"https://github.com/iTwin/changed-elements-tutorial",target:"_blank"},"Tutorial Repository")),(0,r.kt)("p",null,"This is the github repository containing the prebuilt sample that you will use in this\ntutorial.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(m,{href:"https://www.google.com/chrome/",target:"_blank",title:"Google Chrome",icon:(0,r.kt)(T,{mdxType:"GoogleChromeIcon"}),mdxType:"LinkButton"}),(0,r.kt)(m,{href:"https://code.visualstudio.com/",target:"_blank",title:"Visual Studio Code",icon:(0,r.kt)(f,{mdxType:"VSCodeIcon"}),mdxType:"LinkButton"}),(0,r.kt)(m,{href:"https://www.postman.com/downloads/",target:"_blank",title:"Postman",icon:(0,r.kt)(w,{mdxType:"PostmanIcon"}),mdxType:"LinkButton"})],mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"12-suggested-materials"},"1.2 Suggested materials"),(0,r.kt)("h5",{id:"a-hrefhttpswwwgooglecomchrome-target_blankgoogle-chromea"},(0,r.kt)("a",{href:"https://www.google.com/chrome/",target:"_blank"},"Google Chrome")),(0,r.kt)("p",null,"This software can help you to develop and debug frontend JavaScript problems."),(0,r.kt)("h5",{id:"a-hrefhttpscodevisualstudiocom-target_blankvisual-studio-codea"},(0,r.kt)("a",{href:"https://code.visualstudio.com/",target:"_blank"},"Visual Studio Code")),(0,r.kt)("p",null,"This is our recommended editor and debugger tool for developing iTwin.js applications.\nIt is free, open source and includes a GUI for working with GIT."),(0,r.kt)("h5",{id:"a-hrefhttpswwwpostmancomdownloads-target_blankpostmana"},(0,r.kt)("a",{href:"https://www.postman.com/downloads/",target:"_blank"},"Postman")),(0,r.kt)("p",null,"If you want to test the REST API calls directly, you can use\n",(0,r.kt)("a",{parentName:"p",href:"https://www.postman.com/downloads/"},"Postman")," or any other application capable of sending\nHTTP requests. If you do it this way, you will require an authorization token for the HTTP\nrequests to work."),(0,r.kt)("p",null,"To learn more about how authentication and authorization works in an iTwin powered\napplication, check out the full\n",(0,r.kt)("a",{parentName:"p",href:"/apis/overview/authorization/"},"documentation")," on how to obtain\na valid token.")),(0,r.kt)(u,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"2-step-by-step-guide-to-create-a-report-through-the-reporting-apis"},"2. Step-by-Step Guide to Create a Report through the Reporting APIs"),(0,r.kt)("p",null,"Before diving into the code to create an Insights Report based on iModel data, let\u2019s take\nsome time to understand the workflow and the API calls that are involved."),(0,r.kt)("h3",{id:"workflow-for-imodel-reports"},"Workflow for iModel Reports"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create a new Report."),(0,r.kt)("li",{parentName:"ul"},"Create an empty iModel Mapping."),(0,r.kt)("li",{parentName:"ul"},"Assign the Mapping created to the new Report (create a report mapping)."),(0,r.kt)("li",{parentName:"ul"},"Create one or more Groups under that Mapping."),(0,r.kt)("li",{parentName:"ul"},"Create one or more GroupProperties for each Group."),(0,r.kt)("li",{parentName:"ul"},"Extract your data from the iModel."),(0,r.kt)("li",{parentName:"ul"},"Ensure your Extraction has completed."))),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"21-create-a-report"},"2.1 Create a Report"),(0,r.kt)("p",null,"In this section, we will introduce what a report is and how to create a report using our API.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"211-what-is-a-report"},"2.1.1 What is a Report?"),(0,r.kt)("p",null,"A Report represents a collection of data. The way the Reporting API views a Report is as a\ncollection of Mappings. With the Reporting API, you will assign one or more Mappings to a\nReport to be consumed by some application such as Power BI as a single data source.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(k,{mdxType:"Title"},"Example HTTP Request to Create Report"),(0,r.kt)(y,{language:"http",code:'POST https://api.bentley.com/insights/reporting/reports/ HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json\n{\n    "displayName": "myReport",\n    "description": "myReportDescription",\n    "projectId": "myProjectId"\n}',mdxType:"CodeBlock"}),(0,r.kt)(k,{mdxType:"Title"},"Example result from the Create Report Operation"),(0,r.kt)(y,{language:"json",code:'{\n  "report":{\n    "id":"myReportId",\n    "displayName":"myReport",\n    "description":"myReportDescription",\n    "deleted":false,\n    "_links":{\n      "project":{\n        "href":"https://api.bentley.com/projects/myProjectId"\n      }\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"212-how-do-i-create-a-report-using-the-reporting-api"},"2.1.2 How do I create a Report using the Reporting API?"),(0,r.kt)("p",null,"First of all, you need a Bearer Token to run all the APIs in this tutorial. In order to do\nso, go to our ",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/operations/create-report/"},"documentation"),",\nclick on ",(0,r.kt)("inlineCode",{parentName:"p"},"Try it out")," button. Under ",(0,r.kt)("strong",{parentName:"p"},"Authorization"),", select ",(0,r.kt)("inlineCode",{parentName:"p"},"authorizationCode")," of second\ndropdown button and wait for the token to be generated."),(0,r.kt)("p",null,"For this API request, you need to specify your report name, description and projectId in the\nrequest body. See the sample for details."),(0,r.kt)("p",null,"You can also execute the request directly at the ",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/operations/create-report/"},"Create Report API documentation"),"\npage using the \u201cTry It\u201d button."),(0,r.kt)("p",null,"Take note of the ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," in the response. This will be used later as ",(0,r.kt)("inlineCode",{parentName:"p"},"reportId"),".")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"22-create-a-mapping"},"2.2 Create a Mapping"),(0,r.kt)("p",null,"In this section, we will introduce what a mapping is and how to create a mapping using our API.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"221-what-is-a-mapping"},"2.2.1 What is a Mapping?"),(0,r.kt)("p",null,"The Reporting story begins with Mapping. Mapping is a configuration process where all desired\ndata sources are identified. These Mappings also will help describe what data is desired\nfrom each data source and how to structure it for Insights. The Mapping process will be unique\nfor each type of data source. For example, a Mapping for data from an iModel may not look the\nsame as a Mapping for data from Validation, but ultimately all that data needs to arrive at\none place and that is what Mapping orchestrates for you.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(k,{mdxType:"Title"},"Example HTTP Request to Create Mapping"),(0,r.kt)(y,{language:"http",code:'POST https://api.bentley.com/insights/reporting/datasources/iModels/myIModelId/mappings HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json\n{\n  "displayName":"myMappingName",\n  "description":"myMappingDescription"\n}',mdxType:"CodeBlock"}),(0,r.kt)(k,{mdxType:"Title"},"Example result from the Create Report Operation"),(0,r.kt)(y,{language:"json",code:'{\n  "mapping":{\n    "id":"myMappingId",\n    "displayName":"myMappingName",\n    "description":"myMappingDescription",\n    "_links":{\n      "imodel":{\n        "href":"https://api.bentley.com/imodels/myIModelId"\n      }\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"222-how-do-i-create-a-mapping-using-the-reporting-api"},"2.2.2 How do I create a Mapping using the Reporting API?"),(0,r.kt)("p",null,"Creating a Mapping is simple. All you need to provide is a ",(0,r.kt)("inlineCode",{parentName:"p"},"displayName")," and a ",(0,r.kt)("inlineCode",{parentName:"p"},"description"),".\nSee the sample for details."),(0,r.kt)("p",null,"You can also execute the request directly at the ",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/operations/create-mapping/"},"Create Mapping API documentation"),"\npage using the \u201cTry It\u201d button."),(0,r.kt)("p",null,"Take note of the ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," in the response. This will be used later as ",(0,r.kt)("inlineCode",{parentName:"p"},"mappingId"),".")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"23-link-your-mapping-to-your-report"},"2.3 Link your Mapping to your Report"),(0,r.kt)("p",null,"In this section, we will introduce what a report mapping is and how to create a report mapping\nusing our API.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"231-what-is-a-report-mapping"},"2.3.1 What is a Report Mapping?"),(0,r.kt)("p",null,"Report Mappings are used to assign a Mapping to a Report. This relationship is many-to-many.\nOne report can have many mappings, and one mapping can be assigned to many reports. When generating\nthe Report data, our API will find all the Mappings assigned to this Report and collect data from\neach data source defined by the Mappings.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(k,{mdxType:"Title"},"Example HTTP Request to Create Report Mapping"),(0,r.kt)(y,{language:"http",code:'POST https://api.bentley.com/insights/reporting/reports/myReportId/datasources/iModelMappings HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json\n{\n  "mappingId":"myMappingId"\n}',mdxType:"CodeBlock"}),(0,r.kt)(k,{mdxType:"Title"},"Example result from the Create Report Mapping Operation"),(0,r.kt)(y,{language:"json",code:'{\n  "mapping":{\n    "reportId":"myReportId",\n    "mappingId":"myMappingId",\n    "_links":{\n      "report":{\n        "href":"https://api.bentley.com/insights/reporting/reports/myReportId"\n      }\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"232-how-do-i-create-a-report-mapping-using-the-reporting-api"},"2.3.2 How do I create a Report Mapping using the Reporting API?"),(0,r.kt)("p",null,"See the sample for details."),(0,r.kt)("p",null,"You can also execute the request directly at the ",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/operations/create-report-mapping/"},"Create Report Mapping API documentation"),"\npage using the \u201cTry It\u201d button.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"24-create-a-group"},"2.4 Create a Group"),(0,r.kt)("p",null,"In this section, we will introduce what a group is and how to create a group using our API.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"241-what-is-a-group"},"2.4.1 What is a Group?"),(0,r.kt)("p",null,"A Group is a collection of data defined by a given query or other constraints. In this tutorial,\nyou can consider a Group as a collection of iModel elements.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(k,{mdxType:"Title"},"Example HTTP Request to Create Group"),(0,r.kt)(y,{language:"http",code:'POST https://api.bentley.com/insights/reporting/datasources/iModels/myIModelId/mappings/myMappingId/groups HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json\n{\n  "displayName":"myGroupName",\n  "description":"myGroupDescription",\n  "query":"SELECT * FROM bis.physicalelement"\n}',mdxType:"CodeBlock"}),(0,r.kt)(k,{mdxType:"Title"},"Example result from the Create Group Operation"),(0,r.kt)(y,{language:"json",code:'{\n  "group":{\n    "id":"myGroupId",\n    "displayName":"myGroupName",\n    "description":"myGroupDescription",\n    "query":"SELECT * FROM bis.physicalelement"\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"242-how-do-i-create-a-group-using-the-reporting-api"},"2.4.2 How do I create a Group using the Reporting API?"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"query")," needs to be a valid ",(0,r.kt)("a",{parentName:"p",href:"https://www.itwinjs.org/learning/ecsql/"},"ECSQL")," query that will\nbe executed against the target iModel to build this group. If you are unfamiliar with ECSQL, a\ngreat starter query to get you through this tutorial is ",(0,r.kt)("inlineCode",{parentName:"p"},"SELECT * FROM bis.physicalelement"),". You\ncan use the ",(0,r.kt)("a",{parentName:"p",href:"https://imodelconsole.bentley.com"},"iModel Console")," to explore your iModel in detail\nusing ECSQL."),(0,r.kt)("p",null,"You can also execute the request directly at the ",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/operations/create-group/"},"Create Group API documentation"),"\npage using the \u201cTry It\u201d button."),(0,r.kt)("p",null,"Take note of the ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," in the response. This will be used later as ",(0,r.kt)("inlineCode",{parentName:"p"},"groupId"),".")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"25-create-a-groupproperty"},"2.5 Create a GroupProperty"),(0,r.kt)("p",null,"In this section, we will introduce what a GroupProperty is and how to create a GroupProperty\nusing our API.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"251-what-is-a-groupproperty"},"2.5.1 What is a GroupProperty?"),(0,r.kt)("p",null,"A GroupProperty is a property to be extracted from the iModel elements and how it should be\nidentified in your Report.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(k,{mdxType:"Title"},"Example HTTP Request to Create GroupProperties"),(0,r.kt)(y,{language:"http",code:'POST https://api.bentley.com/insights/reporting/datasources/iModels/myIModelId/mappings/myMappingId/groups/myGroupId/properties HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json\n{\n  "displayName":"Extracted Yaw",\n  "dataType":"Number",\n  "quantityType":"Undefined",\n  "ecProperties":[\n    {\n      "ecSchemaName":"Building",\n      "ecClassName":"Beam",\n      "ecPropertyName":"Yaw",\n      "ecPropertyType":"Number"\n    }\n  ]\n}',mdxType:"CodeBlock"}),(0,r.kt)(k,{mdxType:"Title"},"Example result from the Create GroupProperty Operation"),(0,r.kt)(y,{language:"json",code:'{\n  "property":{\n    "id":"myPropertyId",\n    "displayName":"Extracted Yaw",\n    "dataType":"Number",\n    "quantityType":"Undefined",\n    "ecProperties":[\n      {\n        "ecSchemaName":"Building",\n        "ecClassName":"Beam",\n        "ecPropertyName":"Yaw",\n        "ecPropertyType":"Number"\n      }\n    ]\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"252-how-do-i-create-a-groupproperty-using-the-reporting-api"},"2.5.2 How do I create a GroupProperty using the Reporting API?"),(0,r.kt)("p",null,"You need to define one or multiple properties you want to extract from the each row of data\nreturned by the ",(0,r.kt)("inlineCode",{parentName:"p"},"query")," defined in your Group - each row is an element in the iModel. There\nare some restrictions on the property parameters:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"dataType options: ",(0,r.kt)("inlineCode",{parentName:"li"},'"Boolean"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"Number"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"String"')),(0,r.kt)("li",{parentName:"ul"},"quantityType options: ",(0,r.kt)("inlineCode",{parentName:"li"},'"Undefined"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"Area"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"Distance"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"Force"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"Mass"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"Monetary"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"Time"'),", ",(0,r.kt)("inlineCode",{parentName:"li"},'"Volume"')),(0,r.kt)("li",{parentName:"ul"},"ecPropertyType is a dataType"),(0,r.kt)("li",{parentName:"ul"},"ECProperties are specific to each iModel so check on the iModel before defining them.")),(0,r.kt)("p",null,"Again a great resource to help you understand this configuration and what properties to select\nis the ",(0,r.kt)("a",{parentName:"p",href:"https://imodelconsole.bentley.com"},"iModel Console"),". Navigate to your target iModel and\nenter the ",(0,r.kt)("inlineCode",{parentName:"p"},"query")," you defined earlier when creating a Group. This will provide you with the\ninformation you need to fill the fields like ",(0,r.kt)("inlineCode",{parentName:"p"},"ecSchemaName"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"ecClassName"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"ecPropertyName"),",\netc. If you aren\u2019t able to find any meaningful properties to map for your iModel elements,\n",(0,r.kt)("inlineCode",{parentName:"p"},"Yaw"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Pitch"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"Roll")," are always a safe bet when it comes to 3D geometric elements."),(0,r.kt)("p",null,"You can also execute the request directly at the ",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/operations/create-groupproperty/"},"Create GroupProperty API documentation"),"\npage using the \u201cTry It\u201d button.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"26-run-a-data-extraction"},"2.6 Run a Data Extraction"),(0,r.kt)("p",null,"In this section, we will introduce what a data extraction is and how to create a data extraction and check extraction status using our API.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"261-what-is-a-data-extraction"},"2.6.1 What is a data Extraction?"),(0,r.kt)("p",null,"More often than not, some preprocessing will be required before the data defined in a Mapping\nis actually available to be consumed as a Report. Endpoints are provided in the Reporting API\nto trigger the data Extraction process. Depending on the data source this may be a one-time\naction, required for data syncs, or not required at all. See data source specific\n",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/overview"},"documentation")," to find out more."),(0,r.kt)("p",null,"For iModels as a data source, data Extraction is a background process that runs the queries\ndefined by each Group in each Mapping to extract iModel elements and the specified properties.\nEach data Extraction will run all the Mappings linked to all Reports associated with an iModel.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(k,{mdxType:"Title"},"Example HTTP Request to run a data extraction"),(0,r.kt)(y,{language:"http",code:"POST https://api.bentley.com/insights/reporting/datasources/iModels/myIModelId/extraction/run HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"}),(0,r.kt)(k,{mdxType:"Title"},"Example result from the run data extraction Operation"),(0,r.kt)(y,{language:"json",code:'{\n  "run":{\n    "id":"myExtractionJobId"\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"262-how-do-i-run-a-data-extraction-using-the-reporting-api"},"2.6.2 How do I run a data Extraction using the Reporting API?"),(0,r.kt)("p",null,"See the sample for more details."),(0,r.kt)("p",null,"You can also execute the request directly at the ",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/operations/run-extraction/"},"Run Extraction API documentation"),"\npage using the \u201cTry It\u201d button.")),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(k,{mdxType:"Title"},"Example HTTP Request to get extraction status"),(0,r.kt)(y,{language:"http",code:"GET https://api.bentley.com/insights/reporting/datasources/iModels/myIModelId/extraction/status/myExtractionJobId HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"}),(0,r.kt)(k,{mdxType:"Title"},"Example result from the get extraction status Operation"),(0,r.kt)(y,{language:"json",code:'{\n  "status":{\n    "state":"Succeeded",\n    "reason":"Completed"\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"263-how-do-i-check-the-status-of-an-extraction-using-the-reporting-api"},"2.6.3 How do I check the status of an Extraction using the Reporting API?"),(0,r.kt)("p",null,"Run this GET request with ",(0,r.kt)("inlineCode",{parentName:"p"},"run.id")," from response of the last step. See the sample for more\ndetails."),(0,r.kt)("p",null,"You can also execute the request directly at the ",(0,r.kt)("a",{parentName:"p",href:"/apis/insights/operations/get-extraction-status/"},"Get Extraction Status API documentation"),"\npage using the \u201cTry It\u201d button."),(0,r.kt)(N,{type:"informational",mdxType:"Alert"},"The returned state could be Pending, Running, Succeeded, or Failed.")),(0,r.kt)(u,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"3-a-sample-typescript-console-application"},"3. A Sample TypeScript Console Application"),(0,r.kt)("p",null,"Please download the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/iTwin/insights-api-sample-console-app"},"sample app"),". We\nwill be walking you through how to configure the application to programmatically configure and\nprepare a Report.")),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"31-project-structure"},"3.1 Project Structure"),(0,r.kt)("p",null,"The full project structure of this app is explained below:"),(0,r.kt)("blockquote",null,(0,r.kt)("table",{parentName:"blockquote"},(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".vscode:"),(0,r.kt)("td",{parentName:"tr",align:null},"Contains VS Code specific settings")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".github:"),(0,r.kt)("td",{parentName:"tr",align:null},"Contains Github related files")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"lib:"),(0,r.kt)("td",{parentName:"tr",align:null},"Contains the distributable (or output) from your TypeScript build. This is the code you ship")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"src:"),(0,r.kt)("td",{parentName:"tr",align:null},"Contains source code that will be compiled to the dist dir")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"src/Main.ts"),":"),(0,r.kt)("td",{parentName:"tr",align:null},"Main entry point for executing API requests to create report based on iModel data")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"package.json:"),(0,r.kt)("td",{parentName:"tr",align:null},"File that contains npm dependencies as well as build scripts")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"tsconfig.json:"),(0,r.kt)("td",{parentName:"tr",align:null},"Config settings for compiling server code written in TypeScript")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"config.json:"),(0,r.kt)("td",{parentName:"tr",align:null},"Config settings for authentication and iModel data extraction related configurations")))))),(0,r.kt)(u,{subSection:!0,actions:[(0,r.kt)(k,{mdxType:"Title"},"Sample Config File"),(0,r.kt)(y,{language:"json",code:'{\n  "projectId":"myProjectId",\n  "iModelId":"myIModelId",\n  "reportName":"SampleReport",\n  "mappingName":"SampleMapping",\n  "groupName":"SampleGroup",\n  "groupCreateQuery":"SELECT * FROM bis.physicalelement",\n  "groupProperty":{\n    "displayName":"SampleGroupProperty",\n    "dataType":"Number",\n    "quantityType":"Undefined",\n    "ecProperties":[\n      {\n        "ecSchemaName":"BuildingTemplate_NM",\n        "ecClassName":"Concrete__x0020__Beam",\n        "ecPropertyName":"Yaw",\n        "ecPropertyType":"Number"\n      }\n    ]\n  },\n  "authorization":{\n    "clientId":"",\n    "issuerUrl":"https://ims.bentley.com",\n    "redirectUri":"http://localhost:3000/signin-callback",\n    "scope":"openid insights:read insights:modify"\n  },\n  "timeoutMS":600000\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"32-configuration"},"3.2 Configuration"),(0,r.kt)("h4",{id:"how-to-setup-configjson"},"How to setup ",(0,r.kt)("inlineCode",{parentName:"h4"},"config.json"),"."),(0,r.kt)("p",null,"The entire sample application can be controlled using the configuration file located at\n",(0,r.kt)("inlineCode",{parentName:"p"},"src/config.json"),". What is provided is a sample configuration file and you will have to replace\nmost values with your parameters for your own setup. Most of the key concepts have been\nexplained in the earlier step-by-step breakdown of the workflow."),(0,r.kt)("blockquote",null,(0,r.kt)("table",{parentName:"blockquote"},(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"clientId:"),(0,r.kt)("td",{parentName:"tr",align:null},"You should have obtained this from the ",(0,r.kt)("a",{parentName:"td",href:"#1-set-up-your-environment"},"preparation step"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"scope:"),(0,r.kt)("td",{parentName:"tr",align:null},"Must have ",(0,r.kt)("inlineCode",{parentName:"td"},"openid")," scope for authorization and ",(0,r.kt)("inlineCode",{parentName:"td"},"insights:read")," & ",(0,r.kt)("inlineCode",{parentName:"td"},"insights:modify")," scopes for Reporting platform APIs.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"timeoutMS:"),(0,r.kt)("td",{parentName:"tr",align:null},"This is a safeguard parameter to prevent the sample app from running indefinitely if an error occurs during Extraction.")))))),(0,r.kt)(u,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"33-run-the-app"},"3.3 Run the app"),(0,r.kt)("p",null,"Open a terminal/console window and navigate to the folder containing the\n",(0,r.kt)("inlineCode",{parentName:"p"},"insights-api-sample-console-app")," project."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh","data-language":"sh","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:"cd insights-api-sample-console-app\n"}})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Install dependencies"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-sh","data-language":"sh","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:"npm install\n"}}))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Build and run the project"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-sh","data-language":"sh","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:"npm run build\nnpm run start\n"}}))))),(0,r.kt)(u,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"Congratulations on completing this tutorial, at this point you should have been able to run\nthe typical report creation and data extraction workflow using the Reporting API! Now you can\ntake the Reporting API and create your own customized Groups and GroupProperties and map\nthem to your own customized Reports. You can run Extractions based on the Groups and Mappings\nyou defined and generate Reports which can be consumed through other application such as Power\nBI.")),(0,r.kt)(b,{mdxType:"ContinueLearningSection"},(0,r.kt)("h2",{id:"more-resources-that-you-may-like"},"More resources that you may like"),(0,r.kt)(I,{mdxType:"TileList"},(0,r.kt)(C,{title:"Reporting API Documentation",href:"/apis/insights/",description:"This is the official documentation of Reporting API.",mdxType:"ResourceTile"}))))}S.isMDXComponent=!0;var P=function(){return[{id:"introduction",level:2,title:"Introduction",children:[]},{id:"1-set-up-your-environment",level:2,title:"1. Set up your environment",children:[{id:"11-required-materials",level:3,title:"1.1 Required materials",children:[]},{id:"12-suggested-materials",level:3,title:"1.2 Suggested materials",children:[]}]},{id:"2-step-by-step-guide-to-create-a-report-through-the-reporting-apis",level:2,title:"2. Step-by-Step Guide to Create a Report through the Reporting APIs",children:[{id:"workflow-for-imodel-reports",level:3,title:"Workflow for iModel Reports",children:[]},{id:"21-create-a-report",level:3,title:"2.1 Create a Report",children:[]},{id:"22-create-a-mapping",level:3,title:"2.2 Create a Mapping",children:[]},{id:"23-link-your-mapping-to-your-report",level:3,title:"2.3 Link your Mapping to your Report",children:[]},{id:"24-create-a-group",level:3,title:"2.4 Create a Group",children:[]},{id:"25-create-a-groupproperty",level:3,title:"2.5 Create a GroupProperty",children:[]},{id:"26-run-a-data-extraction",level:3,title:"2.6 Run a Data Extraction",children:[]}]},{id:"3-a-sample-typescript-console-application",level:2,title:"3. A Sample TypeScript Console Application",children:[{id:"31-project-structure",level:3,title:"3.1 Project Structure",children:[]},{id:"32-configuration",level:3,title:"3.2 Configuration",children:[]},{id:"33-run-the-app",level:3,title:"3.3 Run the app",children:[]}]},{id:"conclusion",level:2,title:"Conclusion",children:[]},{id:"more-resources-that-you-may-like",level:2,title:"More resources that you may like",children:[]}]}}}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4407],{80989:function(n,e,t){"use strict";t.d(e,{d:function(){return i}});var r=t(9008),a=t(85893);function i(n){var e=n.title;return(0,a.jsx)(r.default,{children:(0,a.jsx)("title",{children:e})})}},141:function(n,e,t){"use strict";t.d(e,{A:function(){return s}});var r=t(53164),a=t(6971),i=t(31993),o=t(85893);function s(n){var e=n.flagName,t=n.children,s=(0,r.L)();return null==s[e]?(0,o.jsx)(i.b,{isFullPage:!0}):s[e]?t:(0,o.jsx)(a.T,{})}},31993:function(n,e,t){"use strict";t.d(e,{b:function(){return i}});t(36581);var r=t(26034),a=t(85893);function i(n){var e=n.isFullPage,t=void 0!==e&&e,i=n.hasSecondaryHeader,o=void 0!==i&&i,s=(0,a.jsx)("div",{className:"spinner-page-overlay",children:(0,a.jsx)(r.p,{indeterminate:!0})});return t?(0,a.jsx)("div",{className:o?"full-page-with-secondary-header-overlay-container":"full-page-overlay-container",children:s}):s}},212:function(n,e,t){"use strict";t.d(e,{T:function(){return i}});var r=t(34023),a=t(85893);function i(){return(0,a.jsx)("div",{id:"error-page",children:(0,a.jsx)(r.m,{errorMessage:"The page you are looking for does not exist.",errorType:"404"})})}},6971:function(n,e,t){"use strict";t.d(e,{T:function(){return r.T}});var r=t(212)},70803:function(n,e,t){"use strict";t.d(e,{q:function(){return o}});var r=t(67294),a=t(55475),i=t(35818);function o(){var n=(0,i.nu)(),e=(0,i.WQ)();(0,r.useEffect)((function(){!n&&e&&a.O.signin()}),[n,e])}},44283:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return A}});var r=t(70803),a=t(80989),i=t(30266),o=t(809),s=t.n(o),c=t(29e3),l=t(24506),u=t(67294),d=t(68216),p=t(25997),f=t(9669),m=t.n(f),v=t(4232),h=t(80853),g=t(51477),x=function(){function n(){(0,d.Z)(this,n)}return(0,p.Z)(n,null,[{key:"getConsumption",value:function(){var n=(0,i.Z)(s().mark((function n(e){var t,r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t="/usage",e.from&&(t=g.c.addQueryParameter(t,"dateTimeFrom=".concat(e.from))),e.to&&(t=g.c.addQueryParameter(t,"dateTimeTo=".concat(e.to))),n.next=5,m().get(t,{headers:{Authorization:"Bearer ".concat((0,v.hP)())},baseURL:h.v.apiBaseUrl});case 5:return r=n.sent,n.abrupt("return",r.data);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}]),n}(),j=t(70978),y=t(23098),b=t(15390),C=t(31668),w=t(85893),N=function(n){var e=n.onChange,t=n.value,r=n.className;return(0,w.jsx)(C.J2,{content:(0,w.jsx)(j.Mt,{date:t,onChange:function(n){return n&&e(n)}}),trigger:"click",children:(0,w.jsx)(y.L,{displayStyle:"inline",iconDisplayStyle:"inline",svgIcon:(0,w.jsx)(b.ceO,{}),readOnly:!0,value:t.toDateString(),className:r})})},T=(t(7423),t(86668)),O=t(60508),P=t(41664),S=t(61686),k=(t(70989),function(n){var e=n.state,t=n.consumptionData,r=(0,u.useMemo)((function(){return[{Header:"Consumption",columns:[{id:"application",Header:"Application",Cell:function(n){return(0,w.jsx)(w.Fragment,{children:0===n.row.depth?(0,w.jsx)(P.default,{href:"/apps/[clientType]/[clientId]",as:n.row.original.appPath,passHref:!0,children:(0,w.jsx)("a",{href:"/",className:"consumption-table-app-name",children:n.row.original.name})}):(0,w.jsx)("span",{className:"consumption-table-app-name sub-row-alignment",children:n.row.original.name})})}},{id:"consumed",Header:"Consumed",accessor:"consumed",cellClassName:"consumption-table-number-cell",maxWidth:150},{id:"totalCredits",Header:"Total credits consumed",cellClassName:"consumption-table-number-cell",maxWidth:200,Cell:function(n){return(0,w.jsx)(w.Fragment,{children:(e=n.row,e.depth>0?(0,w.jsxs)("div",{className:"consumption-table-total-info",children:[n.row.original.totalCredits," cr",(0,w.jsx)(T.u,{content:"".concat(n.row.original.name," rate is 1 cr per ").concat(n.row.original.rate),trigger:"mouseenter click",children:(0,w.jsx)("span",{children:(0,w.jsx)(b.u$m,{className:"consumption-table-info-icon"})})})]}):(0,w.jsxs)("div",{className:"consumption-table-app-total-info",children:[n.row.original.totalCredits," cr"]}))});var e}}]}]}),[]),a=(0,u.useMemo)((function(){var n;return(null!==(n=null===t||void 0===t?void 0:t.Apps)&&void 0!==n?n:[]).map((function(n){return{name:n.ClientName,id:n.ClientId,appPath:"".concat(S.ei,"/").concat(n.ClientType,"/").concat(n.ClientId),totalCredits:n.TotalCredits,subRows:n.Apis.map((function(n){return{name:n.ApiName,rate:"".concat(n.UnitsPerCredit," ").concat(n.Unit),consumed:"".concat(n.TotalConsumption," ").concat(n.Unit),totalCredits:n.TotalCredits}}))}}))}),[t]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(O.i,{columns:r,data:a,emptyTableContent:"error"===e?"Could not get consumption data. Please try again later.":"There is no consumption data available.",isLoading:"loading"===e}),(0,w.jsx)("div",{className:"consumption-table-footer",children:(null===t||void 0===t?void 0:t.TotalCredits)&&"Total credit consumption: ".concat(null===t||void 0===t?void 0:t.TotalCredits," cr")})]})}),_=function(){var n=new Date;n.setDate(1);var e=(0,u.useState)(n),t=e[0],r=e[1],a=(0,u.useState)(new Date),o=a[0],d=a[1],p=(0,u.useState)(),f=p[0],m=p[1],v=(0,u.useState)("loading"),h=v[0],g=v[1],j=(0,u.useCallback)((0,i.Z)(s().mark((function n(){var e;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return g("loading"),m(void 0),n.prev=2,n.next=5,x.getConsumption({from:t.toISOString(),to:o.toISOString()});case 5:e=n.sent,m(e),g("success"),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(2),g("error");case 13:case"end":return n.stop()}}),n,null,[[2,10]])}))),[t,o]);return u.useEffect((function(){j()}),[]),(0,w.jsxs)("div",{id:"page",className:"consumption-page",children:[(0,w.jsx)(c.s,{children:"iTwin Platform credit consumption"}),(0,w.jsxs)("div",{className:"date-filters",children:[(0,w.jsx)("span",{children:"Date range"}),(0,w.jsx)(N,{value:t,onChange:r,className:"date-input"}),(0,w.jsx)(N,{value:o,onChange:d,className:"date-input"}),(0,w.jsx)(l.z,{onClick:function(){return j()},children:"Apply filter"})]}),(0,w.jsx)("div",{children:(0,w.jsx)(k,{state:h,consumptionData:f})})]})},E=t(141);var A=function(){return(0,r.q)(),(0,w.jsx)(E.A,{flagName:"consumption-page",children:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(a.d,{title:"Consumption | iTwin Platform"}),(0,w.jsx)(_,{})]})})}},86668:function(n,e,t){"use strict";t.d(e,{u:function(){return u}});var r=t(67294),a=t(94184),i=t.n(a),o=t(58820),s=t(31668),c=(t(75199),function(){return(c=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var a in e=arguments[t])Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}).apply(this,arguments)}),l=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]])}return t},u=function(n){var e=n.content,t=n.children,a=n.className,u=n.style,d=n.visible,p=n.ref,f=n.id,m=l(n,["content","children","className","style","visible","ref","id"]);return(0,o.F)(),r.createElement(s.J2,c({visible:d,interactive:!1,content:r.createElement("div",{className:i()("iui-tooltip",a),style:u,role:"tooltip",id:f},e),offset:[0,4],ref:p},m),t&&r.cloneElement(t,{title:void 0}))}},61348:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/consumption",function(){return t(44283)}])},75199:function(){},36581:function(){},7423:function(){},70989:function(){}},function(n){n.O(0,[8273,508,4023,8832,9774,2888,179],(function(){return e=61348,n(n.s=e);var e}));var e=n.O();_N_E=e}]);
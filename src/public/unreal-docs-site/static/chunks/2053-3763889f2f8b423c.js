"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2053],{32053:function(e,t,n){n.d(t,{Jt:function(){return w},Pu:function(){return l},ZP:function(){return N}});var o=n(36864),i=n(4730),a=n(67294),r=n(3905),s=["components"],l=(a.createElement,{title:"Synchronize a file from iTwin Storage",tile:{name:"Synchronize a file from iTwin Storage",description:"Walk-through how to synchronize a file from iTwin Storage to an iModel using Synchronization API.",thumbnail:"/images/synchronizationThumbnail.png",href:"/tutorials/synchronization-storage-tutorial/",durationInMinutes:30,relatedApiIds:["synchronization","imodels","storage"]}}),c=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)}},p=c("Introduction"),d=c("TutorialSection"),u=c("LinkButton"),h=c("PostmanIcon"),m=c("Alert"),k=c("CreateSampleAppButton"),f=c("CodeBlock"),y=c("ContinueLearningSection"),g=c("TileList"),T=c("Tile"),I=c("ResourceTile"),b={metadata:l};function N(e){var t=e.components,n=(0,i.Z)(e,s);return(0,r.kt)("wrapper",(0,o.Z)({},b,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(p,{skillLevel:"Basic",durationInMinutes:"30",mdxType:"Introduction"},(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"This is a walk-through of how to synchronize a file from iTwin Storage to an iModel using Synchronization API. Synchronization API works in iTwin and iModel context. To synchronize a set of files a connection has to be created. Connection is an aggregation of properties like file metadata which is needed for synchronization. Connections can be run on demand which starts a file specified in the connection conversion to an iModel.")),(0,r.kt)(d,{actions:[(0,r.kt)(u,{href:"https://www.postman.com/downloads/",target:"_blank",title:"Postman",icon:(0,r.kt)(h,{mdxType:"PostmanIcon"}),mdxType:"LinkButton"})],mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"This tutorial assumes that you:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Already have a tool such as ",(0,r.kt)("inlineCode",{parentName:"li"},"Postman")," that can be used to execute HTTP calls. These calls can also be made using the ",(0,r.kt)("strong",{parentName:"li"},"Try it out")," button in the API documentation or any other HTTP request tool."),(0,r.kt)("li",{parentName:"ul"},"Familiar with concepts of Authorization, iModel, iTwin, Project & Storage."),(0,r.kt)("li",{parentName:"ul"},"Have created a iTwin and have its ",(0,r.kt)("inlineCode",{parentName:"li"},"ITWIN_ID"),". You can create a iTwin using ",(0,r.kt)("a",{parentName:"li",href:"/apis/itwins/operations/create-itwin/"},"iTwins API"),"."),(0,r.kt)("li",{parentName:"ul"},"Have files uploaded inside the iTwin (or Project) by using previously created ",(0,r.kt)("inlineCode",{parentName:"li"},"ITWIN_ID")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"PROJECT_ID"),". If you do not have files in the Storage, follow ",(0,r.kt)("a",{parentName:"li",href:"/tutorials/storage-quick-start/"},"Storage API tutorial")," or consult with ",(0,r.kt)("a",{parentName:"li",href:"/apis/storage/"},"Storage API documentation"),". You may use generated ",(0,r.kt)("inlineCode",{parentName:"li"},"ITWIN_ID")," instead of ",(0,r.kt)("inlineCode",{parentName:"li"},"PROJECT_ID")," in Storage API endpoints.")),(0,r.kt)(m,{type:"informational",mdxType:"Alert"},"If you have already created a project with files inside it - you may use PROJECT_ID instead ITWIN_ID in this tutorial.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"1-preparing-to-use-synchronization-api"},"1. Preparing to use Synchronization API"),(0,r.kt)("p",null,"There are some actions, which should be completed before starting using Synchronization API.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(k,{clientName:"Synchronization tutorial",scopes:["synchronization:read","synchronization:modify","imodels:read","imodels:modify","storage:read"],mdxType:"CreateSampleAppButton"})],mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"11-register-an-application"},"1.1. Register an Application"),(0,r.kt)("p",null,"You will need to register an application to use the iTwin Platform APIs. You can use the ",(0,r.kt)("strong",{parentName:"p"},"Register")," button to automatically create your first single page application (SPA). This will allow you to configure ",(0,r.kt)("a",{parentName:"p",href:"/apis/overview/authorization/#authorize-single-page-applications-spa-and-desktopmobile-applications-native"},"Authorization Code Flow for your SPA application")," and get the correct access token."),(0,r.kt)("p",null,"Once generated, you will be shown a few lines of code under the button."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_CLIENT_ID")," - this is the unique identifier for your application. Displayed on application details page as ",(0,r.kt)("strong",{parentName:"li"},"Client ID"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_REDIRECT_URI")," - specifies where users are redirected after they have chosen whether or not to authenticate your app. Displayed on application details page as one of ",(0,r.kt)("strong",{parentName:"li"},"Redirect URIs"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_LOGOUT_URI")," - specifies where users can be returned to after logging out. Displayed on application details page as one of ",(0,r.kt)("strong",{parentName:"li"},"Post logout redirect URIs"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_SCOPES")," - list of accesses granted to the application. Displayed on application details page as ",(0,r.kt)("strong",{parentName:"li"},"Scopes"),".")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Or optionally:")," Register and configure your application manually following instructions in ",(0,r.kt)("a",{parentName:"p",href:"/tutorials/register-and-modify-application/"},"Register and modify an Application")," tutorial.\nMake sure that your application is associated with ",(0,r.kt)("strong",{parentName:"p"},"Synchronization"),", ",(0,r.kt)("strong",{parentName:"p"},"iModels")," and ",(0,r.kt)("strong",{parentName:"p"},"Storage")," APIs and has ",(0,r.kt)("inlineCode",{parentName:"p"},"synchronization:read synchronization:modify imodels:read imodels:modify storage:read")," scopes enabled."))),(0,r.kt)(d,{subSection:!0,mdxType:"TutorialSection"},(0,r.kt)("h3",{id:"12-get-a-token"},"1.2. Get a token"),(0,r.kt)("p",null,"To make request to API user token is needed. There are several ways to get it."),(0,r.kt)("h4",{id:"implement-authorization-code-flow-in-the-application"},"Implement Authorization Code Flow in the application"),(0,r.kt)("p",null,"Follow this ",(0,r.kt)("a",{parentName:"p",href:"/apis/overview/authorization/"},"article")," to implement Authorization code workflow in your application."),(0,r.kt)("h4",{id:"grab-a-token-from-api-reference-try-it-section"},"Grab a token from Api reference \u201cTry it\u201d Section"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Go to ",(0,r.kt)("a",{parentName:"li",href:"/apis/synchronization/operations/create-storage-connection/"},"Create Storage Connection")),(0,r.kt)("li",{parentName:"ol"},"Click \u201cTry it out\u201d button."),(0,r.kt)("li",{parentName:"ol"},"On Authorization section select \u201cAuthorizationCode\u201d."),(0,r.kt)("li",{parentName:"ol"},"After popup closes Authorization header with token value should be visible."),(0,r.kt)("li",{parentName:"ol"},"Save token value for this tutorial."))),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"2-create-an-imodel"},"2. Create an iModel"),(0,r.kt)("p",null,"An iModel is a specialized information container for exchanging data associated with the lifecycle of infrastructure assets.\niModels were created to facilitate the sharing and distribution of information regardless of the source and format of the information."),(0,r.kt)("p",null,"iTwin Platform iModels API is based on iModelHub cloud service which enables alignment, accountability and accessibility of infrastructure digital twins.\nIt is the control center for iModels and is responsible for coordinating concurrent access to iModels as well as changes made to them."),(0,r.kt)(m,{type:"informational",mdxType:"Alert"},"Note that this step assumes that You already have a ITWIN_ID from previously created iTwin.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"http",code:"POST https://api.bentley.com/imodels HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json\nAccept: application/vnd.bentley.itwin-platform.v2+json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request"},"Request"),(0,r.kt)("p",null,"An empty iModel is created by sending a HTTP POST message to ",(0,r.kt)("a",{parentName:"p",href:"https://api.bentley.com/imodels/"},"https://api.bentley.com/imodels/")," endpoint with the payload describing the iModel to be created."),(0,r.kt)("p",null,"You can execute the request on the ",(0,r.kt)("a",{parentName:"p",href:"/apis/imodels-v2/operations/create-imodel/"},"iModel API Documentation")," page, \u201cTry it out\u201d section.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"json",code:'{\n      "iTwinId": "ITWIN_ID",\n      "name": "Sun City Renewable-energy Plant",\n      "description": "Overall model of solar farms in Sun City",\n      "extent": {\n          "southWest": {\n            "latitude": 46.13267702834806,\n            "longitude": 7.672120009938448\n          },\n          "northEast": {\n            "latitude": 46.302763954781234,\n            "longitude": 7.835541640797823\n          }\n        }\n    }',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-body"},"Request Body"),(0,r.kt)("p",null,"There are two required properties for the create iModel payload."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"name")," - iModel name is required which uniquely identifies the iModel within the Project. ",(0,r.kt)("br",null),"\n",(0,r.kt)("strong",{parentName:"p"},"iTwinId")," - provides iTwin identifier that created iModel will belong to. iTwin identifier is a required property. ",(0,r.kt)("br",null),"\n",(0,r.kt)("strong",{parentName:"p"},"description")," - free form text field so you could give more information about the iModel. ",(0,r.kt)("br",null),"\n",(0,r.kt)("strong",{parentName:"p"},"extent")," - iModels usually are placed at some location on the Earth.\nThis property allows the specification of the maximum rectangular area on the Earth which encloses the iModel.\nThe maximum extent is used to help keep your iModel clean.\nWhen new elements are imported, those outside the extent will be flagged for further processing.\nThis extent will also help to zoom into the area of interest in web viewers."),(0,r.kt)(m,{type:"informational",mdxType:"Alert"},'If you get a response code 404 with the message "Requested iTwin is not available.", Please check if App or User has access to the iTwin.'),(0,r.kt)(m,{type:"informational",mdxType:"Alert"},"Note that after completing this step, you will be provided with an IMODEL_ID which will be required in later steps.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"3-get-file_id-from-storage-api"},"3. Get FILE_ID from Storage API"),(0,r.kt)("p",null,"iTwin File Storage API store files and folders under some folder. To get root files and folder we can use \u201cGet top level folders and files by project\u201d API.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"http",code:"GET https://api.bentley.com/storage/?projectId=ITWIN_ID HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-1"},"Request"),(0,r.kt)("p",null,"That can be done by sending a GET ",(0,r.kt)("a",{parentName:"p",href:"https://api.bentley.com/storage/?projectId=ITWIN_ID"},"https://api.bentley.com/storage/?projectId=ITWIN_ID")," request."),(0,r.kt)("p",null,"You can execute the request on the ",(0,r.kt)("a",{parentName:"p",href:"/apis/storage/operations/get-top-level-folders-and-files-by-project/"},"Storage API Documentation")," page, \u201cTry it out\u201d section."),(0,r.kt)("p",null,"Requirements:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"ITWIN_ID where files and folders are stored."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"json",code:'{\n    "items": [{\n        "id": "FOLDER_ID",\n        "type": "folder",\n        "displayName": "1",\n        "description": null,\n        "path": "1",\n        "lastModifiedByDisplayName": "Joe User",\n        "createdDateTime": "2019-07-16T08:41:05.6415752Z",\n        "lastModifiedDateTime": "2020-01-07T08:46:47.5422276Z",\n        "parentFolderId": "mCbnk2CSr0K4bAkoDGgNEZgm55Ngkq9CuGwJKAxoDRE",\n        "_links": {\n            "createdBy": {\n                "href": "https://api.bentley.com/projects/6959daff-27f5-4b87-96ea-9917daa3a8ff/members/4ebeaf72-3c42-4734-b41a-485c6c2ecb67"\n            },\n            "lastModifiedBy": {\n                "href": "https://api.bentley.com/projects/6959daff-27f5-4b87-96ea-9917daa3a8ff/members/4ebeaf72-3c42-4734-b41a-485c6c2ecb67"\n            },\n            "parentFolder": {\n                "href": "https://api.bentley.com/storage/folders/mCbnk2CSr0K4bAkoDGgNEZgm55Ngkq9CuGwJKAxoDRE"\n            }\n        }\n    },{\n        "id": "FILE_ID",\n        "type": "file",\n        "displayName": "Test.dgn",\n        "description": null,\n        "path": "Test.dgn",\n        "size": "38400",\n        "lastModifiedByDisplayName": "Joe User",\n        "createdDateTime": "2020-06-23T11:13:42.3498148Z",\n        "lastModifiedDateTime": "2020-07-07T11:46:44.9573652Z",\n        "parentFolderId": "mCbnk2CSr0K4bAkoDGgNEZgm55Ngkq9CuGwJKAxoDRE",\n        "_links": {\n            "createdBy": {\n                "href": "https://api.bentley.com/projects/6959daff-27f5-4b87-96ea-9917daa3a8ff/members/4ebeaf72-3c42-4734-b41a-485c6c2ecb67"\n            },\n            "lastModifiedBy": {\n                "href": "https://api.bentley.com/projects/6959daff-27f5-4b87-96ea-9917daa3a8ff/members/4ebeaf72-3c42-4734-b41a-485c6c2ecb67"\n            },\n            "parentFolder": {\n                "href": "https://api.bentley.com/storage/folders/mCbnk2CSr0K4bAkoDGgNEZgm55Ngkq9CuGwJKAxoDRE"\n            }\n        }\n    }],\n    "_links": {\n        "self": {\n            "href": "https://api.bentley.com/storage?projectId=PROJECT_ID&$skip=0&$top=100"\n        },\n        "prev": {\n            "href": "https://api.bentley.com/storage?projectId=PROJECT_ID&$skip=0&$top=100"\n        },\n        "next": {\n            "href": "https://api.bentley.com/storage?projectId=PROJECT_ID&$skip=100&$top=100"\n        },\n        "folder": {\n            "href": "https://api.bentley.com/storage/folders/mCbnk2CSr0K4bAkoDGgNEZgm55Ngkq9CuGwJKAxoDRE"\n        }\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response"},"Response"),(0,r.kt)("p",null,"The request response contains a FILE_ID which will be used in next step.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"4-create-a-connection"},"4. Create a Connection"),(0,r.kt)("p",null,"The synchronization process is based on connections that establish links from design files to iModels. There could be multiple connections for an iModel, and those could be executed on-demand multiple times to synchronize changes. In this step we will be creating such connection.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"http",code:"POST\xa0https://api.bentley.com/synchronization/imodels/storageConnections HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-2"},"Request"),(0,r.kt)("p",null,"To create a connection, send a ",(0,r.kt)("inlineCode",{parentName:"p"},"POST")," request to the ",(0,r.kt)("inlineCode",{parentName:"p"},"synchronization/imodels/storageConnections")," endpoint."),(0,r.kt)("p",null,"You can execute the request on the ",(0,r.kt)("a",{parentName:"p",href:"/apis/synchronization/operations/create-storage-connection/"},"Synchronization API Documentation")," page, \u201cTry it out\u201d section."),(0,r.kt)("p",null,"Requirements:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"IMODEL_ID of created iModel from step 3."),(0,r.kt)("li",{parentName:"ol"},"We will need to specify what file from File Storage should be mapped to a connection. To do that we will need a FILE_ID from previous step response."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"json",code:'{\n    "displayName": "Connection1",\n    "iModelId": "IMODEL_ID",\n    "sourceFiles": [{\n        "storageFileId": "FILE_ID",\n        "connectorType": "MSTN"\n    }]\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-body-1"},"Request Body"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"displayName")," - user facing connection name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"iModelId"),": - iModel Id which should contain created connection"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"sourceFiles")," - information about source files from File Storage",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"storageFileId")," - id of the file from Storage API"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"connectorType")," - identifier of the connector used to process the file. For more information, see ",(0,r.kt)("a",{parentName:"li",href:"/apis/synchronization/supported-formats/"},"Supported formats.")),(0,r.kt)("li",{parentName:"ul"},"[Optional]"," ",(0,r.kt)("strong",{parentName:"li"},"authenticationType")," - defaults to ",(0,r.kt)("strong",{parentName:"li"},"User")," and uses a refresh token to get an access token for long synchronizations. But it can be set to ",(0,r.kt)("strong",{parentName:"li"},"Service")," when API is used from server application without user context."))))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"json",code:'{\n    "connection": {\n        "id": "CONNECTION_ID",\n        "displayName": "connection1",\n        "iModelId": "IMODEL_ID",\n        "iTwinId": "ITWIN_ID",\n        "_links": {\n            "iModel": {\n                "href": "https://api.bentley.com/imodels/IMODEL_ID"\n            },\n            "iTwin": {\n                "href": "https://api.bentley.com/itwins/ITWIN_ID"\n            },\n            "lastRun": null\n        }\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response-1"},"Response"),(0,r.kt)("p",null,"The request response contains created connection properties values. Id is going to be needed in next step")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"5-store-refresh-token-for-user"},"5. Store refresh token for user"),(0,r.kt)("p",null,"The synchronization process usually takes time and is performed in the background. For that, we need to store the connection owner\u2019s refresh token. You can get it by using Get Authorization Information API. This API will return the current status and a redirect URL where user has to be redirected on the browser if the token has to be renewed."),(0,r.kt)(m,{type:"informational",mdxType:"Alert"},"Note that if connection authenticationType is set to ",(0,r.kt)("strong",null,"Service")," ","this step should be skipped.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"http",code:"GET https://api.bentley.com/synchronization/imodels/connections/authorizationInformation?redirectUrl=REDIRECT_URL HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-3"},"Request"),(0,r.kt)("p",null,"That can be done by sending a GET ",(0,r.kt)("a",{parentName:"p",href:"https://api.bentley.com/synchronization/imodels/connections/authorizationInformation?redirectUrl=REDIRECT_URL"},"https://api.bentley.com/synchronization/imodels/connections/authorizationInformation?redirectUrl=REDIRECT_URL")," request."),(0,r.kt)("p",null,"You can execute the request on the ",(0,r.kt)("a",{parentName:"p",href:"/apis/synchronization/operations/get-authorization-information/"},"Synchronization API Documentation")," page, \u201cTry it out\u201d section."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization\xa0header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"REDIRECT_URL a url of where a user should be redirected after successful token renewal."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"json",code:'{\n    "authorizationInformation": {\n        "isUserAuthorized": true,\n        "_links": {\n            "authorizationUrl": {\n                "href": null\n            }\n        }\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response-if-user-has-a-valid-refresh-token"},"Response if user has a valid refresh token"),(0,r.kt)("p",null,"isUserAuthorized with value true, means that user has a valid refresh token and can run long running synchronizations.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"json",code:'{\n    "authorizationInformation": {\n        "isUserAuthorized": false,\n        "_links": {\n            "authorizationUrl": {\n                "href": "https://connect-itwinbridgeportal.bentley.com/authenticate?redirect_url=REDIRECT_URL"\n            }\n        }\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response-if-user-does-not-have-a-valid-refresh-token"},"Response if user does not have a valid refresh token"),(0,r.kt)("p",null,"isUserAuthorized with value false, means that user does not have valid refresh token and cannot run long running synchronizations. To refresh token user has to be redirected to authorizationUrl from response.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"6-run-a-connection"},"6. Run a Connection"),(0,r.kt)("p",null,"A Run defines a single Connection synchronization process. It can be initialized manually by sending run start request.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"http",code:"POST\xa0https://api.bentley.com/synchronization/imodels/storageConnections/CONNECTION_ID/run HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-4"},"Request"),(0,r.kt)("p",null,"Send a ",(0,r.kt)("inlineCode",{parentName:"p"},"POST")," request to the ",(0,r.kt)("inlineCode",{parentName:"p"},"synchronization/imodels/connections/{connectionId}/runs")," endpoint with valid connectionId to run a connection."),(0,r.kt)("p",null,"You can execute the request on the ",(0,r.kt)("a",{parentName:"p",href:"/apis/synchronization/operations/run-storage-connection/"},"Synchronization API Documentation")," page, \u201cTry it out\u201d section."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"CONNECTION_ID which should be started for processing. Use the value from previous step response."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"http",code:"HTTP/1.1 202 Accepted",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response-2"},"Response"),(0,r.kt)("p",null,"On successful request, operation returns http status code 202/accepted - the request is accepted for processing and will be executed in the background.\nIf there is already an active run in progress for this connection, new run is being added to the queue.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"7-get-runs-statuses"},"7. Get runs statuses"),(0,r.kt)("p",null,"A run contains synchronization process status. To get runs history and statuses get request has to be made.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"http",code:"POST\xa0https://api.bentley.com/synchronization/imodels/storageConnections/CONNECTION_ID/runs HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-5"},"Request"),(0,r.kt)("p",null,"Getting Run status requires sending a GET request to the synchronization/imodels/storageConnections/{connectionId}/runs endpoint with valid connectionId."),(0,r.kt)("p",null,"You can execute the request on the ",(0,r.kt)("a",{parentName:"p",href:"/apis/synchronization/operations/get-storage-connection-runs/"},"Synchronization API Documentation")," page, \u201cTry it out\u201d section."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"CONNECTION_ID which runs we want to get."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(f,{language:"json",code:'{\n  "runs":[\n    {\n      "id":"41062244-3e62-42a3-8232-9f2b4d31be16",\n      "state":"Completed",\n      "result":"Success"\n    }\n  ],\n  "_links":{\n    "self":{\n      "href":"https://api.bentley.com/Synchronization/imodels/storageConnections/CONNECTION_ID/runs?$skip=0&$top=100"\n    },\n    "prev":{\n      "href":"https://api.bentley.com/Synchronization/imodels/storageConnections/CONNECTION_ID/runs?$skip=0&$top=100"\n    },\n    "next":{\n      "href":"https://api.bentley.com/Synchronization/imodels/storageConnections/CONNECTION_ID/runs?$skip=100&$top=100"\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h5",{id:"response-3"},"Response"),(0,r.kt)("p",null,"At the end of synchronization run state should be \u201cCompleted\u201d and result \u201cSuccess\u201d.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"8-synchronize-an-updated-file"},"8. Synchronize an updated file"),(0,r.kt)("p",null,"If a file is changed on iTwin storage, it has to be synchronized again for the iModel to be updated. The workflow should be:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"File is updated on iTwin Storage."),(0,r.kt)("li",{parentName:"ol"},"Run the connection again. (See step 7)"),(0,r.kt)("li",{parentName:"ol"},"Get connection run status. (See step 8)"))),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"8-conclusion"},"8. Conclusion"),(0,r.kt)("p",null,"In this tutorial we have gone through a file from iTwin Storage synchronization process:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create a connection"),(0,r.kt)("li",{parentName:"ol"},"Run the connection"),(0,r.kt)("li",{parentName:"ol"},"Get run status.")),(0,r.kt)("p",null,"After successful run, design file changes should be in an iModel. Next step could be to create a Named Version.")),(0,r.kt)(y,{mdxType:"ContinueLearningSection"},(0,r.kt)("h2",{id:"continue-learning"},"Continue learning"),(0,r.kt)("p",null,"Congratulations for the completion of your first synchronization! You\u2019ve now know a lot on the subject, but there\u2019s still possibilities to learn more to unleash the platform capabilities."),(0,r.kt)(g,{mdxType:"TileList"},(0,r.kt)(T,{name:"Create iModel Named Version",description:"This quick start is intended to guide you through the steps to create a new iModel Named Version.",href:"/tutorials/create-named-version",mdxType:"Tile"})),(0,r.kt)("h2",{id:"more-resources-that-you-may-like"},"More resources that you may like"),(0,r.kt)(g,{mdxType:"TileList"},(0,r.kt)(I,{title:"Synchronization API documentation",href:"/api-groups/synchronization",description:"An overview and detailed Synchronization API documentation.",mdxType:"ResourceTile"}),(0,r.kt)(I,{title:"Synchronization API code sample",href:"https://github.com/iTwin/synchronization-api-sample-app",description:"A working code sample showing how Synchronization API can be integrated into a React application.",isExternal:!0,mdxType:"ResourceTile"}),(0,r.kt)(I,{title:"Data Management API documentation",href:"/api-groups/data-management/",description:"An overview and detailed Data Management API documentation.",mdxType:"ResourceTile"}))))}N.isMDXComponent=!0;var w=function(){return[{id:"introduction",level:2,title:"Introduction",children:[]},{id:"prerequisites",level:2,title:"Prerequisites",children:[]},{id:"1-preparing-to-use-synchronization-api",level:2,title:"1. Preparing to use Synchronization API",children:[{id:"11-register-an-application",level:3,title:"1.1. Register an Application",children:[]},{id:"12-get-a-token",level:3,title:"1.2. Get a token",children:[]}]},{id:"2-create-an-imodel",level:2,title:"2. Create an iModel",children:[]},{id:"3-get-file_id-from-storage-api",level:2,title:"3. Get FILE_ID from Storage API",children:[]},{id:"4-create-a-connection",level:2,title:"4. Create a Connection",children:[]},{id:"5-store-refresh-token-for-user",level:2,title:"5. Store refresh token for user",children:[]},{id:"6-run-a-connection",level:2,title:"6. Run a Connection",children:[]},{id:"7-get-runs-statuses",level:2,title:"7. Get runs statuses",children:[]},{id:"8-synchronize-an-updated-file",level:2,title:"8. Synchronize an updated file",children:[]},{id:"8-conclusion",level:2,title:"8. Conclusion",children:[]},{id:"continue-learning",level:2,title:"Continue learning",children:[]},{id:"more-resources-that-you-may-like",level:2,title:"More resources that you may like",children:[]}]}}}]);
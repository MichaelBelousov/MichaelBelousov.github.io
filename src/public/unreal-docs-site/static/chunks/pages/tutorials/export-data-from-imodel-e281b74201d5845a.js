(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9709],{1962:function(e,t,n){"use strict";n.d(t,{Jt:function(){return C},Pu:function(){return s},ZP:function(){return I}});var o=n(36864),i=n(4730),a=n(67294),r=n(3905),l=["components"],s=(a.createElement,{title:"Export data from an iModel",tile:{name:"Export data from an iModel",description:"This tutorial guides you through exporting data from an iModel to other formats, such as IFC or LandXM using the Export API.",href:"/tutorials/export-data-from-imodel/",durationInMinutes:30,relatedApiIds:["export","imodels"]}}),p=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)}},u=p("Introduction"),d=p("TutorialSection"),c=p("CreateSampleAppButton"),h=p("Alert"),k=p("CodeBlock"),m=p("Title"),f=p("ContinueLearningSection"),T=p("TileList"),y=p("Tile"),g=p("ResourceTile"),N={metadata:s};function I(e){var t=e.components,n=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,o.Z)({},N,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(u,{skillLevel:"Intermediate",durationInMinutes:"30",mdxType:"Introduction"},(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"This quick start is intended to help you export data from an iModel to different formats like ",(0,r.kt)("a",{parentName:"p",href:"https://www.buildingsmart.org/standards/bsi-standards/industry-foundation-classes/"},"IFC")," or ",(0,r.kt)("a",{parentName:"p",href:"http://www.landxml.org/"},"LandXML")," and store it in the iTwin Storage. Export API works in project and iModel context.\nIn this walk-through, you will be able to start an export.")),(0,r.kt)(d,{actions:[(0,r.kt)(c,{scopes:["export:modify","export:read"],clientName:"Export data from an iModel tutorial",mdxType:"CreateSampleAppButton"})],mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"1-register-an-application"},"1. Register an Application"),(0,r.kt)("p",null,"You will need to register an application to use the iTwin Platform APIs. Use the ",(0,r.kt)("strong",{parentName:"p"},"Register")," button to automatically create your first single page application (SPA). This will allow you to configure ",(0,r.kt)("a",{parentName:"p",href:"/apis/overview/authorization/#authorize-single-page-applications-spa-and-desktopmobile-applications-native"},"Authorization Code Flow for your SPA application")," and get the correct access token."),(0,r.kt)("p",null,"Once generated, you will be shown a few lines of code under the button."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_CLIENT_ID")," - this is the unique identifier for your application. Displayed on application details page as ",(0,r.kt)("strong",{parentName:"li"},"Client ID"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_REDIRECT_URI")," - specifies where users are redirected after they have chosen whether or not to authenticate your app. Displayed on application details page as one of ",(0,r.kt)("strong",{parentName:"li"},"Redirect URIs"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_LOGOUT_URI")," - specifies where users can be returned to after logging out. Displayed on application details page as one of ",(0,r.kt)("strong",{parentName:"li"},"Post logout redirect URIs"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMJS_AUTH_CLIENT_SCOPES")," - list of accesses granted to the application. Displayed on application details page as ",(0,r.kt)("strong",{parentName:"li"},"Scopes"),".")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Or optionally:")," Register and configure your application manually following instructions in ",(0,r.kt)("a",{parentName:"p",href:"/tutorials/register-and-modify-application/"},"Register and modify an Application")," tutorial.\nMake sure that your application is associated with ",(0,r.kt)("strong",{parentName:"p"},"Export API")," and has ",(0,r.kt)("inlineCode",{parentName:"p"},"export:modify export:read")," scopes enabled."))),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"2-get-a-token"},"2. Get a token"),(0,r.kt)("p",null,"To make requests to the API, a user token is needed. There are several ways to get it."),(0,r.kt)("h3",{id:"implement-authorization-code-flow-in-the-application"},"Implement Authorization Code Flow in the application"),(0,r.kt)("p",null,"Follow this ",(0,r.kt)("a",{parentName:"p",href:"/apis/overview/authorization/"},"article")," to implement Authorization code workflow in your application."),(0,r.kt)(h,{type:"informational",mdxType:"Alert"},"Here you need to use Client ID generated from previous registration step."),(0,r.kt)("h3",{id:"grab-a-user-token-from-api-reference-try-it-out-section"},"Grab a user token from Api reference \u201cTry it out\u201d Section"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Go to ",(0,r.kt)("a",{parentName:"li",href:"/apis/export/operations/startExport/"},"Create Configuration")),(0,r.kt)("li",{parentName:"ol"},"Click \u201cTry it out\u201d button."),(0,r.kt)("li",{parentName:"ol"},"On Authorization section select \u201cAuthorizationCode\u201d."),(0,r.kt)("li",{parentName:"ol"},"After popup closes Authorization header with your user token value should be visible."),(0,r.kt)("li",{parentName:"ol"},"Save user token value for this tutorial.")),(0,r.kt)(h,{type:"informational",mdxType:"Alert"},"Use user token to replace JWT_TOKEN dynamic parameter in the next steps.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"3-create-a-connection"},"3. Create a Connection"),(0,r.kt)("p",null,"The export process uses connections that link to iModels. For example, you can create multiple connections to an iModel and execute them on-demand multiple times to export changes. So let\u2019s make such a connection in this step.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(k,{language:"http",code:"POST\xa0https://api.bentley.com/export/connections HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request"},"Request"),(0,r.kt)("p",null,"To create a connection, send a ",(0,r.kt)("inlineCode",{parentName:"p"},"POST")," request to the ",(0,r.kt)("inlineCode",{parentName:"p"},"export/connections")," endpoint."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization\xa0header with a valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"IMODEL_ID of the iModel we want to export."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(k,{language:"json",code:'{\n    "displayName": "Connection1",\n    "iModelId": "IMODEL_ID",\n    "authenticationType": "User"\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-body"},"Request Body"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"displayName")," - a user-friendly name for the connection"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"iModelId")," - The ID of the iModel containing the connection"),(0,r.kt)("li",{parentName:"ul"},"[Optional]"," ",(0,r.kt)("inlineCode",{parentName:"li"},"authenticationType")," - one of ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"Service"),". The authentication type defaults to ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," and uses a refresh token to get an access token for long exports. For now Export only supports ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," authenticationType."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(k,{language:"json",code:'{\n    "connection": {\n        "id": "CONNECTION_ID",\n        "displayName": "connection1",\n        "iModelId": "IMODEL_ID",\n        "projectId": "PROJECT_ID",\n        "authenticationType": "User",\n        "_links": {\n            "iModel": {\n                "href": "https://api.bentley.com/imodels/IMODEL_ID"\n            },\n            "project": {\n                "href": "https://api.bentley.com/projects/PROJECT_ID"\n            },\n            "lastRun": null\n        }\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response"},"Response"),(0,r.kt)("p",null,"The request response contains created connection properties values. Id is needed in next step")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"4-store-refresh-token-for-user"},"4. Store refresh token for user"),(0,r.kt)("p",null,"The export process usually takes time and is performed in the background. For that, we need to store the user\u2019s refresh token. To get the authorization information, use the Get Authorization Information API. This API will return the current status and a redirect URL where user has to be redirected on the browser if the token has to be renewed.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(m,{mdxType:"Title"},"Get Authorization Information Request Syntax and Headers"),(0,r.kt)(k,{language:"http",code:"GET https://api.bentley.com/export/authorizationInformation?redirectUrl=REDIRECT_URL HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-1"},"Request"),(0,r.kt)("p",null,"In order to do that, send a GET ",(0,r.kt)("a",{parentName:"p",href:"https://api.bentley.com/export/authorizationInformation?redirectUrl=REDIRECT_URL"},"https://api.bentley.com/export/authorizationInformation?redirectUrl=REDIRECT_URL")," request."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization\xa0header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"REDIRECT_URL is a url of where a user should be redirected after successful token renewal."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(m,{mdxType:"Title"},"Get Authorization Information Response Body"),(0,r.kt)(k,{language:"json",code:'{\n    "authorizationInformation": {\n        "isUserAuthorized": true,\n        "_links": {\n            "authorizationUrl": {\n                "href": null\n            }\n        }\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response-if-user-has-a-valid-refresh-token"},"Response if user has a valid refresh token"),(0,r.kt)("p",null,"\u201cisUserAuthorized\u201d with value \u201ctrue\u201d means, user has a valid refresh token and can run long running export.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(m,{mdxType:"Title"},"Get Authorization Information Response Body"),(0,r.kt)(k,{language:"json",code:'{\n    "authorizationInformation": {\n        "isUserAuthorized": false,\n        "_links": {\n            "authorizationUrl": {\n                "href": "https://connect-itwinbridgeportal.bentley.com/authenticate?redirect_url=REDIRECT_URL"\n            }\n        }\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response-if-user-does-not-have-a-valid-refresh-token"},"Response if user does not have a valid refresh token"),(0,r.kt)("p",null,"\u201cisUserAuthorized\u201d with value \u201cfalse\u201d means, user does not have valid refresh token and cannot run long running export. To refresh token user has to be redirected to authorizationUrl from response.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"5-run-a-connection"},"5. Run a Connection"),(0,r.kt)("p",null,"A run defines a single connection export process. Send a ",(0,r.kt)("inlineCode",{parentName:"p"},"run start")," request to initialize the export process."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"exportType")," is a required property. Valid values are ",(0,r.kt)("inlineCode",{parentName:"p"},"IFC")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"LandXML"),". Additionally, the following optional parameters are also available:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"inputOptions")," -"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"changesetId")," - Changeset Id of the iModel."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"mappingFileId")," - User-defined mapping file Id."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"outputOptions")," -"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"folderId")," - Folder Id to store the output file."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"saveLogs")," - Set to save the logs of export."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"replaceOlderFile")," - Set to replace the older file for same imodel."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"location")," - Location type one of \u201cUSER_BLOBS_TORAGE\u201d or 'STORAGE\u2019. Defaults to STORAGE (STORAGE API)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"outputSasUrl")," - Output file SAS url if the location is 'USER_BLOBS_TORAGE\u2019."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"logsSasUrl")," - Logs file SAS url if the location is \u201cUSER_BLOBS_TORAGE\u201d ans saveLogs is set."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ifcVersion")," - Ifc Version if the export type is \u201cIFC\u201d (One of 'IFC4.3\u2019, 'IFC2x3\u2019, 'IFC2x3 CV 2.0\u2019, 'IFC4 RV 1.2\u2019).")))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(k,{language:"http",code:"POST\xa0https://api.bentley.com/export/connections/CONNECTION_ID/run HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"}),(0,r.kt)(m,{mdxType:"Title"},"Request Body"),(0,r.kt)(k,{language:"json",code:'{\n  "exportType": "ExportType",\n  "ifcVersion": "IfcVersion",\n  "projectId": "ProjectId",\n  "inputOptions": {\n        "mappingFileId": "MappingFileId",\n        "changesetId": "ChangesetId"\n    },\n  "outputOptions": {\n        "location": "Location",\n        "outputSasUrl": "OutputSasUrl",\n        "logsSasUrl": "LogsSasUrl",\n        "folderId": "FolderId",\n        "replaceOlderFile": true,\n        "saveLogs": true\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-2"},"Request"),(0,r.kt)("p",null,"Send a ",(0,r.kt)("inlineCode",{parentName:"p"},"POST")," request to the ",(0,r.kt)("inlineCode",{parentName:"p"},"export/connections/{connectionId}/runs"),"\xa0endpoint with valid connectionId to run a connection."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization\xa0header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"CONNECTION_ID which should be started for processing. Use the value from previous step response."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(k,{language:"http",code:"HTTP/1.1 202 Accepted",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response-1"},"Response"),(0,r.kt)("p",null,"On successful request, operation returns http status code 202/accepted - the request is accepted for processing and will be executed in the background.\nIf there is already an active run in progress for this connection, new run is being added to the queue.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"6-get-runs-statuses"},"6. Get runs statuses"),(0,r.kt)("p",null,"A run contains export process status. To get runs history and statuses get request has to be made.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(k,{language:"http",code:"POST\xa0https://api.bentley.com/export/connections/CONNECTION_ID/runs HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-3"},"Request"),(0,r.kt)("p",null,"Getting Run status requires sending a GET request to the export/connections/{connectionId}/runs\xa0endpoint with valid connectionId."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authorization\xa0header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ol"},"CONNECTION_ID which runs we want to get."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(k,{language:"json",code:'{\n  "runs":[\n    {\n      "id":"41062244-3e62-42a3-8232-9f2b4d31be16",\n      "state":"Completed",\n      "result":"Success"\n    }\n  ],\n  "_links":{\n    "self":{\n      "href":"https://api.bentley.com/export/connections/CONNECTION_ID/runs?$skip=0&$top=100"\n    },\n    "prev":{\n      "href":"https://api.bentley.com/export/connections/CONNECTION_ID/runs?$skip=0&$top=100"\n    },\n    "next":{\n      "href":"https://api.bentley.com/export/connections/CONNECTION_ID/runs?$skip=100&$top=100"\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h5",{id:"response-2"},"Response"),(0,r.kt)("p",null,"At the end of export, the run state should be ",(0,r.kt)("inlineCode",{parentName:"p"},"Completed"),", and result ",(0,r.kt)("inlineCode",{parentName:"p"},"Success"),".")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"7-conclusion"},"7. Conclusion"),(0,r.kt)("p",null,"In this tutorial we have gone through a iModel export process:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create a connection"),(0,r.kt)("li",{parentName:"ol"},"Run the connection"),(0,r.kt)("li",{parentName:"ol"},"Get run status.")),(0,r.kt)("p",null,"After successful run, output file could be found in the location provided (Storage API by default).")),(0,r.kt)(f,{mdxType:"ContinueLearningSection"},(0,r.kt)("h2",{id:"continue-learning"},"Continue learning"),(0,r.kt)(T,{mdxType:"TileList"},(0,r.kt)(y,{name:"Synchronize an iModel using Synchronization API",description:"You will learn how to use the synchronization REST API to synchronize data to iModel.",href:"/tutorials/synchronization-storage-tutorial/",mdxType:"Tile"}),(0,r.kt)(y,{name:"Filter an iModel using Transformation API",description:"You will learn how to use the transformation REST API to filter iModel data.",href:"/tutorials/filter-by-view-definition-transformation/",mdxType:"Tile"}),(0,r.kt)(y,{name:"Get started with Storage API",description:"You will learn the main workflows and operations of the storage REST API.",href:"/tutorials/storage-quick-start/",mdxType:"Tile"})),(0,r.kt)("h2",{id:"more-resources-that-you-may-like"},"More resources that you may like"),(0,r.kt)(T,{mdxType:"TileList"},(0,r.kt)(g,{title:"Export API documentation",href:"/apis/export/overview",description:"An overview and detailed Export API documentation.",mdxType:"ResourceTile"}))))}I.isMDXComponent=!0;var C=function(){return[{id:"introduction",level:2,title:"Introduction",children:[]},{id:"1-register-an-application",level:2,title:"1. Register an Application",children:[]},{id:"2-get-a-token",level:2,title:"2. Get a token",children:[{id:"implement-authorization-code-flow-in-the-application",level:3,title:"Implement Authorization Code Flow in the application",children:[]},{id:"grab-a-user-token-from-api-reference-try-it-out-section",level:3,title:"Grab a user token from Api reference \u201cTry it out\u201d Section",children:[]}]},{id:"3-create-a-connection",level:2,title:"3. Create a Connection",children:[]},{id:"4-store-refresh-token-for-user",level:2,title:"4. Store refresh token for user",children:[]},{id:"5-run-a-connection",level:2,title:"5. Run a Connection",children:[]},{id:"6-get-runs-statuses",level:2,title:"6. Get runs statuses",children:[]},{id:"7-conclusion",level:2,title:"7. Conclusion",children:[]},{id:"continue-learning",level:2,title:"Continue learning",children:[]},{id:"more-resources-that-you-may-like",level:2,title:"More resources that you may like",children:[]}]}},41986:function(e,t,n){"use strict";n.r(t);var o=n(3905),i=n(1176),a=n(58822),r=n(1962),l=(n(67294),n(80989)),s=n(85893);n(14473),t.default=function(){var e={headline:r.Pu.title,navigationItems:(0,r.Jt)(),tutorialSteps:(0,s.jsx)(o.Zo,{components:a.d,children:(0,s.jsx)(r.ZP,{})})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.d,{title:"".concat(r.Pu.title," - Tutorials | iTwin Platform")}),(0,s.jsx)(i.Z,{tutorial:e})]})}},34492:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorials/export-data-from-imodel",function(){return n(41986)}])}},function(e){e.O(0,[3714,8670,9734,9102,8764,1706,4009,1610,6638,9774,2888,179],(function(){return t=34492,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
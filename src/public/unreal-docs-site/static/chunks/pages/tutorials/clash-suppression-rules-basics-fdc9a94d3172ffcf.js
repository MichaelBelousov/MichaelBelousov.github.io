(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7378],{54625:function(e,t,n){"use strict";n.d(t,{Jt:function(){return w},Pu:function(){return l},ZP:function(){return f}});var s=n(36864),o=n(4730),i=n(67294),a=n(3905),r=["components"],l=(i.createElement,{title:"Clash Suppression Rules Basics",tile:{name:"Clash Suppression Rules Basics",description:"Walk-through of the creation and usage of suppression rules for clash detection tests.",href:"/tutorials/clash-suppression-rules-basics/",thumbnail:"/unreal-docs-site/static/images/ClashDetectionSample.png",durationInMinutes:20,relatedApiIds:["clashdetection"]}}),p=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.kt)("div",t)}},u=p("Introduction"),d=p("TutorialSection"),c=p("Alert"),h=p("Title"),m=p("CodeBlock"),y=p("ContinueLearningSection"),k=p("TileList"),T=p("ResourceTile"),g={metadata:l};function f(e){var t=e.components,n=(0,o.Z)(e,r);return(0,a.kt)("wrapper",(0,s.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(u,{skillLevel:"Intermediate",durationInMinutes:"20",mdxType:"Introduction"},(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,"Suppression rules are rules for clash detection tests that will allow you to filter out potentially unwanted results based on properties of either or both of the clashing elements. In this tutorial, you will learn how to:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Create a suppression rule"),(0,a.kt)("li",{parentName:"ul"},"Associate a suppression rule with a test"),(0,a.kt)("li",{parentName:"ul"},"Interpret the results of a test using suppression rules"),(0,a.kt)("li",{parentName:"ul"},"Update your suppression rule"),(0,a.kt)("li",{parentName:"ul"},"Delete your suppression rule"))),(0,a.kt)(d,{mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"This tutorial assumes that you already have:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Access to an iModel and the associated projectId and imodelId for that iModel, along with the named version ID for the version you want to run the test against\n-If you do not have a model, instructions on creating one and retrieving the associated model data can be found ",(0,a.kt)("a",{parentName:"li",href:"/tutorials/retrieve-validation-model-data"},"here")),(0,a.kt)("li",{parentName:"ul"},"Access to an iModel and the associated projectId and imodelId for that iModel, along with the named version ID for the version you want to run the test against"),(0,a.kt)("li",{parentName:"ul"},"Knowledge of how to run a clash detection test",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Instructions on clash test basics, including creation and running are located ",(0,a.kt)("a",{parentName:"li",href:"/tutorials/clash-test-basics"},"here")))),(0,a.kt)("li",{parentName:"ul"},"Property and schema information for the rules you want to implement",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Instructions on retrieving schema information for a specific model can be found ",(0,a.kt)("a",{parentName:"li",href:"/tutorials/retrieve-validation-model-data"},"here")))))),(0,a.kt)(d,{mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"1-get-a-token"},"1. Get a token"),(0,a.kt)("p",null,"To make request to the API a user token is needed. There are several ways to get it."),(0,a.kt)("h3",{id:"implement-authorization-code-flow-in-the-application"},"Implement Authorization Code Flow in the application"),(0,a.kt)("p",null,"Follow this ",(0,a.kt)("a",{parentName:"p",href:"/apis/overview/authorization/"},"article")," to implement Authorization code workflow in your application. You will need to include the scopes clashdetection:read and clashdetection:modify."),(0,a.kt)("h3",{id:"grab-a-user-token-from-api-reference-try-it-section"},"Grab a user token from Api reference \u201cTry it\u201d Section"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Go ",(0,a.kt)("a",{parentName:"li",href:"/apis/clash-detection/operations/create-clashdetection-tests/"},"here")),(0,a.kt)("li",{parentName:"ol"},"Click \u201cTry it\u201d button."),(0,a.kt)("li",{parentName:"ol"},"On Authorization section select \u201cAuthorizationCode\u201d."),(0,a.kt)("li",{parentName:"ol"},"After popup closes Authorization header with your user token value should be visible."),(0,a.kt)("li",{parentName:"ol"},"Save user token value for this tutorial.")),(0,a.kt)(c,{type:"informational",mdxType:"Alert"},"Use user token to replace JWT_TOKEN dynamic parameter in the next steps.")),(0,a.kt)(d,{actions:[(0,a.kt)(h,{mdxType:"Title"},"Request Syntax"),(0,a.kt)(m,{language:"http",code:"GET https://api.bentley.com/clashdetection/suppressionRuleTemplates?projectId=00000000-0000-0000-0000-000000000000 HTTP/1.1",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Request Headers"),(0,a.kt)(m,{language:"http",code:"Accept: application/vnd.bentley.itwin-platform.v1+json\nPrefer: return=representation\nAuthorization: Bearer JWT_TOKEN",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Response Body"),(0,a.kt)(m,{language:"json",code:'{\n  "suppressionRuleTemplates":[\n    {\n      "id":"0000000000000000000000000000000000000000000",\n      "displayName":"Suppression/Definition/Generic/AnyProperty",\n      "description":"Suppress clashes based on properties of any one of the clashing elements",\n      "prompt":"Suppress clashes if any one of the clashing elements has a property that satisfies the expression: -Expression-. Note: Use wild card "_" to match any single character, and "%" to match multiple characters",\n      "templateExpression":{\n        "propertyExpression":{\n          "relationshipPath":"ArchitecturalPhysical:Door",\n          "propertyName":"Origin",\n          "operator":"IS NOT NULL",\n          "propertyValue":""\n        }\n      }\n    }\n  ],\n  "_links":{\n    "next":{\n      "href":"https://api.bentley.com/clashdetection/suppressionRuleTemplates?projectId=00000000-0000-0000-0000-000000000000&continuationToken=00000000000000000000000000000000000000"\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"2-get-suppression-rules-templates"},"2. Get Suppression Rules Templates"),(0,a.kt)("p",null,"Suppression rules work by checking elements in a valid clash against specific criteria. A rule can suppress a clash based on matching query criteria on a single element in a clash, matching criteria on both elements in a clash, or even matching criteria based on the relationship between two elements in a clash."),(0,a.kt)("p",null,"To make it simpler, we\u2019ve provided a variety of suppression rule templates. A HTTP ",(0,a.kt)("inlineCode",{parentName:"p"},"GET https://api.bentley.com/clashdetection/suppressionRuleTemplates?projectId[&continuationToken][&$top]")," request will return all of the valid suppression rule templates for the given project id. You simply choose the template that sounds best suited for your goals based on the prompt description.")),(0,a.kt)(d,{actions:[(0,a.kt)(h,{mdxType:"Title"},"Request Syntax"),(0,a.kt)(m,{language:"http",code:"POST https://api.bentley.com/clashdetection/suppressionRules HTTP/1.1",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Request Headers"),(0,a.kt)(m,{language:"http",code:"Accept: application/vnd.bentley.itwin-platform.v1+json\nPrefer: return=representation\nAuthorization: Bearer JWT_TOKEN",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Request Body"),(0,a.kt)(m,{language:"json",code:'{\n  "projectId":"00000000-0000-0000-0000-000000000000",\n  "displayName":"Suppress Long Pipes",\n  "reason":"Sample Demo",\n  "templateId":"0000000000000000000000000000000000000000000",\n  "parameters":{\n    "propertyExpression":{\n      "relationshipPath":"ProcessPhysical:IsmCurveMember",\n      "propertyName":"AutoLength",\n      "operator":">",\n      "propertyValue":"24"\n    }\n  }\n}',mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Response Body"),(0,a.kt)(m,{language:"json",code:'{\n  "suppressionRule":{\n    "id":"0000000000000000000000000000000000000000000",\n    "_links":{\n      "self":{\n        "href":"https://api.bentley.com/clashdetection/suppressionRules/0000000000000000000000000000000000000000000"\n      }\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"3-creating-a-suppression-rule"},"3. Creating a Suppression Rule"),(0,a.kt)("p",null,"To create a suppression rule, you need to include the template id of your chosen template, a name for the rule, a reason that describes why the rule exists and what it covers, and the test parameters and send an HTTP request to ",(0,a.kt)("inlineCode",{parentName:"p"},"POST https://api.bentley.com/clashdetection/suppressionRules")),(0,a.kt)("p",null,"The parameters will vary based on your chosen template. Some templates, like 'suppress clashes if clashing elements are in the same category\u2019, don\u2019t require any parameters- we don\u2019t need any more information from you, we can just check the element categories against each other. For templates that do require parameters, you should follow the guidelines set forth by the template expression."),(0,a.kt)("p",null,"For more advanced users, or those who wish to do something a little more complicated that isn\u2019t covered by the standard templates, there are UnaryECSql and BinaryECSql templates that are essentially freeform and allow you to write the desired query criteria yourself in an ECSql expression."),(0,a.kt)("p",null,"If your rule creation is successful, it will return the rule metadata and a rule id. This will be used in the following steps to associate the rule with a test.")),(0,a.kt)(d,{actions:[(0,a.kt)(h,{mdxType:"Title"},"Request Syntax"),(0,a.kt)(m,{language:"http",code:"PUT https://api.bentley.com/clashdetection/tests/000000000000000-000000000000000000000000000 HTTP/1.1",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Request Headers"),(0,a.kt)(m,{language:"http",code:"Accept: application/vnd.bentley.itwin-platform.v1+json\nPrefer: return=representation\nAuthorization: Bearer JWT_TOKEN",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Update Clash Test Request Body"),(0,a.kt)(m,{language:"json",code:'{\n  "projectId":"00000000-0000-0000-0000-000000000000",\n  "displayName":"Sample Test",\n  "description":"Categories: Tag v Structure",\n  "setA":{\n    "modelIds":[],\n    "categoryIds":["0x4000000000d"],\n    "selfCheck":false,\n    "clearance":0\n  },\n  "setB":{\n    "modelIds":[],\n    "categoryIds":["0x40000000e71"],\n    "selfCheck":false,\n    "clearance":0\n  },\n  "suppressTouching":true,\n  "touchingTolerance":0.001,\n  "includeSubModels":false,\n  "suppressionRules":["0000000000000000000000000000000000000000000"]\n}',mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Response Body"),(0,a.kt)(m,{language:"json",code:'{\n  "test":{\n    "id":"000000000000000-000000000000000000000000000",\n    "_links":{\n      "self":{\n        "href":"https://api.bentley.com/clashdetection/tests/000000000000000-000000000000000000000000000"\n      }\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"4-adding-a-suppression-rule-to-a-clash-test"},"4. Adding a Suppression Rule to a Clash Test"),(0,a.kt)("p",null,"You can either use your suppression rule when creating a fresh clash test or when updating a previously created test. If you need a refresher, full instructions and parameter explanations for either option are located ",(0,a.kt)("a",{parentName:"p",href:"/tutorials/clash-test-basics"},"here")),(0,a.kt)("p",null,"The only new step for either option is including a suppression rules array in the request block properties. This will be an array of IDs including the testId returned in the previous creation step, along with any other rules you would want to associate with the test."),(0,a.kt)("p",null,"Note that when updating a test, this is a replacement update, so if there were previously any rules associated with a test, you will need to include them in the array if you want them to continue to be associated with the test. This also means to disassociate a suppression rule with a clash test, all you would have to do is send an update request ",(0,a.kt)("em",{parentName:"p"},"without")," the specified ID in the suppressionRules array.")),(0,a.kt)(d,{actions:[(0,a.kt)(h,{mdxType:"Title"},"Request Syntax"),(0,a.kt)(m,{language:"http",code:"GET https://api.bentley.com/clashdetection/results/000000000000000-000000000000000000000000000 HTTP/1.1",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Request Headers"),(0,a.kt)(m,{language:"http",code:"Accept: application/vnd.bentley.itwin-platform.v1+json\nPrefer: return=representation\nAuthorization: Bearer JWT_TOKEN",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Response Body"),(0,a.kt)(m,{language:"json",code:'{\n  "result":[\n    {\n      "clashType":"Collision",\n      "clearance":-1,\n      "elementAId":"0x400000000c4",\n      "elementALabel":"1-SWS-0104-EX-OPM [4-5G]",\n      "elementACategoryIndex":0,\n      "elementAModelIndex":0,\n      "elementBId":"0x4000000003e",\n      "elementBLabel":"IsmCurveMember [4-1Q]",\n      "elementBCategoryIndex":1,\n      "elementBModelIndex":0,\n      "center":{\n        "x":12.192031860351562,\n        "y":407.69541931152344,\n        "z":122.92329406738281\n      },\n      "suppressingRuleIndexArray":[0]\n    }\n  ],\n  "categoryList":[\n    {\n      "id":"0x4000000000d",\n      "displayName":"Tag-Category"\n    },\n    {\n      "id":"0x40000000e71",\n      "displayName":"Structure"\n    }\n  ],\n  "modelList":[\n    {\n      "id":"0x20000000002",\n      "displayName":"Sample"\n    }\n  ],\n  "suppressingRuleList":[\n    {\n      "id":"0000000000000000000000000000000000000000000",\n      "displayName":"Sample Suppression Rule"\n    }\n  ]\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"5-interpreting-clash-results-with-suppression-rules"},"5. Interpreting Clash Results with Suppression Rules"),(0,a.kt)("p",null,"At this point, you should already understand the basics of how clash tests work and how to run them, so go ahead and run your updated test now, or if you need to, go ",(0,a.kt)("a",{parentName:"p",href:"/tutorials/clash-test-basics"},"here")," to review the process."),(0,a.kt)("p",null,"While the process of running a test hasn\u2019t changed, the results themselves will if there were clashes affected by your new suppression rule. Clashes that fit the suppression rule criteria are not removed from results directly; rather, they have an array property (suppressingRuleIndexArray) that includes the zero-based index of any suppression rule. You can then use this array index to look up the relevant suppressing rule in the suppressingRuleList array, which includes the id and name. This will allow you to see the effect of multiple suppression rules, and which clashes they impact, without having to rerun the test multiple times.")),(0,a.kt)(d,{actions:[(0,a.kt)(h,{mdxType:"Title"},"Request Syntax"),(0,a.kt)(m,{language:"http",code:"PUT https://api.bentley.com/clashdetection/suppressionRules/0000000000000000000000000000000000000000000 HTTP/1.1",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Request Headers"),(0,a.kt)(m,{language:"http",code:"Accept: application/vnd.bentley.itwin-platform.v1+json\nPrefer: return=representation\nAuthorization: Bearer JWT_TOKEN",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Request Body"),(0,a.kt)(m,{language:"json",code:'{\n  "displayName":"Long Pipes Suppression Rule",\n  "reason":"Suppress long pipes over 24 meters."\n}',mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Response Body"),(0,a.kt)(m,{language:"json",code:'{\n  "suppressionRule":{\n    "id":"0000000000000000000000000000000000000000000",\n    "_links":{\n      "self":{\n        "href":"https://api.bentley.com/clashdetection/suppressionRules/0000000000000000000000000000000000000000000"\n      }\n    }\n  }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"6-updating-a-suppression-rule"},"6. Updating a Suppression Rule"),(0,a.kt)("p",null,"To update a suppression rule is relatively simple, all you need to do is send a HTTP ",(0,a.kt)("inlineCode",{parentName:"p"},"PUT https://api.bentley.com/clashdetection/suppressionRules/{id}")," request. However, you can only update the name and reason- you will not be able to change the rule parameters and would have to create a new rule instead. Both parameters are optional, so if you only want to update one or the other, you can only send that property during the update. You will not need to update any of the associated tests- next time you run them, they will returns responses based on the updated rule.")),(0,a.kt)(d,{actions:[(0,a.kt)(h,{mdxType:"Title"},"Request Syntax"),(0,a.kt)(m,{language:"http",code:"DELETE https://api.bentley.com/clashdetection/suppressionRules/0000000000000000000000000000000000000000000 HTTP/1.1",mdxType:"CodeBlock"}),(0,a.kt)(h,{mdxType:"Title"},"Request Headers"),(0,a.kt)(m,{language:"http",code:"Accept: application/vnd.bentley.itwin-platform.v1+json\nPrefer: return=representation\nAuthorization: Bearer JWT_TOKEN",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"7-deleting-a-suppression-rule"},"7. Deleting a Suppression Rule"),(0,a.kt)("p",null,"Deleting a suppression rule is also easy, just send a HTTP request to ",(0,a.kt)("inlineCode",{parentName:"p"},"DELETE https://api.bentley.com/clashdetection/suppressionRules/{id}")," Upon a successful deletion, the response body will be empty; it will only include additional information if the deletion failed."),(0,a.kt)("p",null,"At this time, deleting a suppression rule does not automatically delete them from associated tests, so please make an effort to update the tests in conjunction with the rule deletion to keep things consistent.")),(0,a.kt)(d,{mdxType:"TutorialSection"},(0,a.kt)("h2",{id:"8-conclusion"},"8. Conclusion"),(0,a.kt)("p",null,"You should now be able to successfully create and update suppression rules. This will allow you to filter the number of clashes based on your specified criteria so you only have to spend time investigating the issues you think might need attention.")),(0,a.kt)(y,{mdxType:"ContinueLearningSection"},(0,a.kt)("h2",{id:"more-resources-that-you-may-like"},"More resources that you may like"),(0,a.kt)(k,{mdxType:"TileList"},(0,a.kt)(T,{title:"Validation API documentation",href:"/api-groups/validation/",description:"An overview and detailed version of Validation API documentation, including both Clash Detection and Property Validation.",mdxType:"ResourceTile"}))))}f.isMDXComponent=!0;var w=function(){return[{id:"introduction",level:2,title:"Introduction",children:[]},{id:"prerequisites",level:2,title:"Prerequisites",children:[]},{id:"1-get-a-token",level:2,title:"1. Get a token",children:[{id:"implement-authorization-code-flow-in-the-application",level:3,title:"Implement Authorization Code Flow in the application",children:[]},{id:"grab-a-user-token-from-api-reference-try-it-section",level:3,title:"Grab a user token from Api reference \u201cTry it\u201d Section",children:[]}]},{id:"2-get-suppression-rules-templates",level:2,title:"2. Get Suppression Rules Templates",children:[]},{id:"3-creating-a-suppression-rule",level:2,title:"3. Creating a Suppression Rule",children:[]},{id:"4-adding-a-suppression-rule-to-a-clash-test",level:2,title:"4. Adding a Suppression Rule to a Clash Test",children:[]},{id:"5-interpreting-clash-results-with-suppression-rules",level:2,title:"5. Interpreting Clash Results with Suppression Rules",children:[]},{id:"6-updating-a-suppression-rule",level:2,title:"6. Updating a Suppression Rule",children:[]},{id:"7-deleting-a-suppression-rule",level:2,title:"7. Deleting a Suppression Rule",children:[]},{id:"8-conclusion",level:2,title:"8. Conclusion",children:[]},{id:"more-resources-that-you-may-like",level:2,title:"More resources that you may like",children:[]}]}},30350:function(e,t,n){"use strict";n.r(t);var s=n(3905),o=n(1176),i=n(58822),a=n(54625),r=(n(67294),n(80989)),l=n(85893);n(14473),t.default=function(){var e={headline:a.Pu.title,navigationItems:(0,a.Jt)(),tutorialSteps:(0,l.jsx)(s.Zo,{components:i.d,children:(0,l.jsx)(a.ZP,{})})};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.d,{title:"".concat(a.Pu.title," - Tutorials | iTwin Platform")}),(0,l.jsx)(o.Z,{tutorial:e})]})}},30817:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorials/clash-suppression-rules-basics",function(){return n(30350)}])}},function(e){e.O(0,[3714,8670,9734,9102,8764,1706,4009,1610,6638,9774,2888,179],(function(){return t=30817,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
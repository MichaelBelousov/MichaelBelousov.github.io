(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9265],{78241:function(e,t,n){"use strict";n.d(t,{Jt:function(){return y},Pu:function(){return s},ZP:function(){return f}});var i=n(36864),o=n(4730),a=n(67294),r=n(3905),l=["components"],s=(a.createElement,{title:"Unmap an Azure Blob Storage file from an iModel",tile:{name:"Unmap an Azure Blob Storage file from an iModel",description:"Walk-through how to unmap an Azure Blob Storage file from an iModel using Synchronization API.",thumbnail:"/unreal-docs-site/static/images/synchronizationUnmap.png",href:"/tutorials/unmap-blob-file-tutorial/",durationInMinutes:10,relatedApiIds:["synchronization","imodels"]}}),u=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)}},c=u("Introduction"),d=u("TutorialSection"),p=u("CodeBlock"),h=u("ContinueLearningSection"),m=u("TileList"),k=u("Tile"),g=u("ResourceTile"),T={metadata:s};function f(e){var t=e.components,n=(0,o.Z)(e,l);return(0,r.kt)("wrapper",(0,i.Z)({},T,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(c,{skillLevel:"Basic",durationInMinutes:"10",mdxType:"Introduction"},(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"This tutorial guides you through deleting the mapping of an Azure Blob Storage file using the Synchronization API. All changes, made by the file, will be removed from an iModel. To delete the mapping of a file, the connection has to be run again with the action set to unmap. That means you should already have a connection.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"Since deleting a mapping removes a file from an iModel, the following tasks have to be done before attempting this process:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create an iModel."),(0,r.kt)("li",{parentName:"ul"},"Create a connection."),(0,r.kt)("li",{parentName:"ul"},"Run a connection."),(0,r.kt)("li",{parentName:"ul"},"(Optional) Get connection run status - to confirm that the file is successfully mapped to the iModel.")),(0,r.kt)("p",null,"For a detailed guide, see ",(0,r.kt)("a",{parentName:"p",href:"/tutorials/synchronization-blob-tutorial/"},"Synchronization tutorial"),". If you have completed these tasks, the next steps will guide you through the workflow of deleting a mapping.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"1-run-the-connection-with-unmap-action"},"1. Run the connection with unmap action"),(0,r.kt)("p",null,"This step is similar to simply running the connection for file synchronization, however, the mapping deletion request contains an additional \u201caction\u201d property.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(p,{language:"http",code:"POST\xa0https://api.bentley.com/synchronization/imodels/manifestConnections/CONNECTION_ID/runs HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request"},"Request"),(0,r.kt)("p",null,"To delete a file mapping, send a POST request to the synchronization/imodels/manifestConnections/{connectionId}/runs\xa0endpoint with a valid connection ID."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Authorization\xa0header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ul"},"CONNECTION_ID which should be started for processing."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(p,{language:"json",code:'{\n    "sourceFiles": [{\n        "id": "FILE_ID",\n        "action": "unmap",\n        "connector": "MSTN"\n    }]\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-body"},"Request Body"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"sourceFiles")," - information about source files",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"id")," - id of the file"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"action")," - setting this property to ",(0,r.kt)("strong",{parentName:"li"},"unmap")," will trigger the connection to run the mapping deletion process instead of synchronization"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"connector")," - file connector identifier."))))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(p,{language:"http",code:"HTTP/1.1 202 Accepted",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response"},"Response"),(0,r.kt)("p",null,"On a successful request, the operation returns http status code 202/accepted - the request is accepted for processing and will be executed in the background.\nIf there is an active run in progress for this connection, a new run is added to the queue. The response includes a location header pointing to the created run.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"2-get-run-status"},"2. Get run status"),(0,r.kt)("p",null,"The run from the previous step contains the mapping deletion process status. To track a run and associated status, make a GET request to a link from previous request response location header.")),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(p,{language:"http",code:"GET\xa0https://api.bentley.com/synchronization/imodels/manifestConnections/CONNECTION_ID/runs/RUN_ID HTTP/1.1\nAuthorization: Bearer JWT_TOKEN\nContent-Type: application/json",mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"request-1"},"Request"),(0,r.kt)("p",null,"To get the status of the run, send a GET request to the synchronization/imodels/manifestConnections/{connectionId}/runs/{runId}\xa0endpoint with a valid connection and run ID. For convenience take a link from previous request response location header."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Authorization\xa0header with valid Bearer token is required."),(0,r.kt)("li",{parentName:"ul"},"CONNECTION_ID of the run we want to get."),(0,r.kt)("li",{parentName:"ul"},"RUN_ID of the run we want to get."))),(0,r.kt)(d,{subSection:!0,actions:[(0,r.kt)(p,{language:"json",code:'{\n    "run": {\n        "id": "RUN_ID",\n        "startDateTime": "02/15/2022 08:24:45",\n        "endDateTime": "02/15/2022 08:26:50",\n        "phase": "MasterFile",\n        "jobs": [\n            {\n                "id": "JOB_ID",\n                "startDateTime": "02/15/2022 08:25:58",\n                "endDateTime": "02/15/2022 08:26:28",\n                "state": "Completed",\n                "result": "Success",\n                "connectorType": "MSTN",\n                "tasks": [\n                    {\n                        "id": "TASK_ID",\n                        "startDateTime": "02/15/2022 08:25:58",\n                        "endDateTime": "02/15/2022 08:26:28",\n                        "retryAttempts": 0,\n                        "state": "Completed",\n                        "result": "Success",\n                        "error": null\n                    }\n                ]\n            }\n        ],\n        "state": "Completed",\n        "result": "Success"\n    }\n}',mdxType:"CodeBlock"})],mdxType:"TutorialSection"},(0,r.kt)("h4",{id:"response-1"},"Response"),(0,r.kt)("p",null,"After the mapping deletion process is finished, the run state should be \u201cCompleted\u201d and result \u201cSuccess\u201d.")),(0,r.kt)(d,{mdxType:"TutorialSection"},(0,r.kt)("h2",{id:"3-conclusion"},"3. Conclusion"),(0,r.kt)("p",null,"In this tutorial we have gone through the process of deleting the mapping of an Azure Blob Storage file:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Run the connection with unmap action"),(0,r.kt)("li",{parentName:"ul"},"Get run status.")),(0,r.kt)("p",null,"After a successful run, the iModel should no longer contain the design file.")),(0,r.kt)(h,{mdxType:"ContinueLearningSection"},(0,r.kt)("h2",{id:"continue-learning"},"Continue learning"),(0,r.kt)("p",null,"Congratulations on the completion of your first file mapping deletion process! Now you know a lot on the subject, but there are still possibilities to learn more to unlock the platform capabilities."),(0,r.kt)(m,{mdxType:"TileList"},(0,r.kt)(k,{name:"Create iModel Named Version",description:"This quick start is intended to guide you through the steps to create a new iModel Named Version.",href:"/tutorials/create-named-version",mdxType:"Tile"})),(0,r.kt)("h2",{id:"more-resources-that-you-may-like"},"More resources that you may like"),(0,r.kt)(m,{mdxType:"TileList"},(0,r.kt)(g,{title:"Synchronization API documentation",href:"/api-groups/synchronization",description:"An overview and detailed Synchronization API documentation.",mdxType:"ResourceTile"}),(0,r.kt)(g,{title:"Synchronization API code sample",href:"https://github.com/iTwin/synchronization-api-sample-app",description:"A working code sample showing how Synchronization API can be integrated into a React application.",isExternal:!0,mdxType:"ResourceTile"}),(0,r.kt)(g,{title:"Data Management API documentation",href:"/api-groups/data-management/",description:"An overview and detailed Data Management API documentation.",mdxType:"ResourceTile"}))))}f.isMDXComponent=!0;var y=function(){return[{id:"introduction",level:2,title:"Introduction",children:[]},{id:"prerequisites",level:2,title:"Prerequisites",children:[]},{id:"1-run-the-connection-with-unmap-action",level:2,title:"1. Run the connection with unmap action",children:[]},{id:"2-get-run-status",level:2,title:"2. Get run status",children:[]},{id:"3-conclusion",level:2,title:"3. Conclusion",children:[]},{id:"continue-learning",level:2,title:"Continue learning",children:[]},{id:"more-resources-that-you-may-like",level:2,title:"More resources that you may like",children:[]}]}},18566:function(e,t,n){"use strict";n.r(t);var i=n(3905),o=n(1176),a=n(58822),r=n(78241),l=(n(67294),n(80989)),s=n(85893);n(14473),t.default=function(){var e={headline:r.Pu.title,navigationItems:(0,r.Jt)(),tutorialSteps:(0,s.jsx)(i.Zo,{components:a.d,children:(0,s.jsx)(r.ZP,{})})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.d,{title:"".concat(r.Pu.title," - Tutorials | iTwin Platform")}),(0,s.jsx)(o.Z,{tutorial:e})]})}},81565:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorials/unmap-blob-file-tutorial",function(){return n(18566)}])}},function(e){e.O(0,[3714,8670,9734,9102,8764,1706,4009,1610,6638,9774,2888,179],(function(){return t=81565,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
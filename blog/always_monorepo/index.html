<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.80aff200461880aa68c7.css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}._3d-module--container--3u9YK{display:flex;flex-wrap:wrap}._3d-module--container--3u9YK img{max-height:200px}.work-module--container--31LKz{overflow:hidden}.work-module--pdf--8cbUT{width:100%}@media only screen and (max-width:700px){.header-module--pageWrapper--1ij_0{padding:12px}}@media only screen and (min-width:700px){.header-module--pageWrapper--1ij_0{padding:22px 1in 1in}}.header-module--separate--G80zA{display:flex;align-items:center;justify-content:space-between}.header-module--separate--G80zA .header-module--left--2-ITV{display:flex;flex-direction:row;flex-wrap:wrap;margin-left:-22px;padding:11px}.header-module--separate--G80zA .header-module--left--2-ITV .header-module--navLink--1IuEZ{margin:11px}.header-module--separate--G80zA .header-module--left--2-ITV .header-module--navLink--1IuEZ,.header-module--separate--G80zA .header-module--left--2-ITV .header-module--navLink--1IuEZ:link,.header-module--separate--G80zA .header-module--left--2-ITV .header-module--navLink--1IuEZ:visited{font-size:2rem;color:rgb(var(--body-rgb));text-decoration:initial;font-style:italic;font-weight:700;transition:font-size .1s ease;height:2.5rem;vertical-align:middle}@media only screen and (max-width:700px){.header-module--separate--G80zA .header-module--left--2-ITV .header-module--navLink--1IuEZ,.header-module--separate--G80zA .header-module--left--2-ITV .header-module--navLink--1IuEZ:link,.header-module--separate--G80zA .header-module--left--2-ITV .header-module--navLink--1IuEZ:visited{font-size:1.5rem}}.header-module--separate--G80zA .header-module--left--2-ITV .header-module--navLink--1IuEZ:hover{color:orange;font-size:2.5em}@media only screen and (max-width:700px){.layout-module--pageWrapper--22gEu{padding:12px}}@media only screen and (min-width:700px){.layout-module--pageWrapper--22gEu{padding:22px 1in 1in}}body,html{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:rgb(var(--background-rgb));font-size:14pt;color:rgb(var(--body-rgb))}code{font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace}a{color:#49a9f9}a:visited{color:#69a9f9}a:active{color:#b9b999}h1{font-size:1.4em;font-weight:700}h1,h3{font-style:italic}h3{font-size:1em;font-weight:400}h1+h3{margin-top:-8px}hr{color:rgba(var(--body-rgb),.3)}.blog-module--container--1pCGB{display:flex;flex-direction:column}@keyframes blog-module--spin--1ZuQ_{0%{transform:scaleX(0)}50%{transform:scaleX(1)}to{transform:scaleX(0)}}.blog-module--loader--27Uha{display:flex;align-items:center;justify-content:center}.blog-module--loader--27Uha .blog-module--inner--3N3oy{border:4px solid rgb(var(--body-rgb));height:26px;width:26px;border-radius:50%;animation-name:blog-module--spin--1ZuQ_;animation-duration:1s;animation-iteration-count:infinite;animation-timing-function:ease-out}@media only screen and (min-width:700px){.blog-module--post--oYMJm{padding:0 1in}.blog-module--post--oYMJm *{max-width:100%}}:root{--background-rgb:18,18,24;--body-rgb:239,239,239}.blog-module--blogLink--1dLLs{margin:11px}.blog-module--blogLink--1dLLs,.blog-module--blogLink--1dLLs:link,.blog-module--blogLink--1dLLs:visited{color:rgb(var(--body-rgb));text-decoration:initial;font-weight:700;vertical-align:middle}.blog-module--blogLink--1dLLs:hover{color:orange}</style><meta name="generator" content="Gatsby 2.21.13"/><title data-react-helmet="true">Always use a Monorepo | Mike Belousov&#x27;s Website</title><link data-react-helmet="true" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/paraiso-dark.min.css" crossorigin="anonymous"/><meta data-react-helmet="true" name="description" content="Mike Belousov&#x27;s Website"/><meta data-react-helmet="true" property="og:title" content="Always use a Monorepo"/><meta data-react-helmet="true" property="og:description" content="Mike Belousov&#x27;s Website"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Mike Belousov"/><meta data-react-helmet="true" name="twitter:title" content="Always use a Monorepo"/><meta data-react-helmet="true" name="twitter:description" content="Mike Belousov&#x27;s Website"/><link rel="icon" href="/favicon-32x32.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=bdc2871edacbda8dd5a11f8bfaedcd63"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link as="script" rel="preload" href="/app-fd690b0e9cfcd08a5a70.js"/><link as="script" rel="preload" href="/component---src-components-blog-page-tsx-b3a7ffb70a58157fcdfb.js"/><link as="script" rel="preload" href="/922baf5242ed4ba4672941b22c37e341b7a6f945-54cc9b6a670616ae6283.js"/><link as="script" rel="preload" href="/styles-8636a280cbc61d53ad10.js"/><link as="script" rel="preload" href="/framework-d18255661b01063664e4.js"/><link as="script" rel="preload" href="/webpack-runtime-a185db1d5c95e4b93d98.js"/><link as="fetch" rel="preload" href="/page-data/blog/always_monorepo/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-module--pageWrapper--22gEu"><header><div class="header-module--separate--G80zA"><div class="header-module--left--2-ITV"><a class="header-module--navLink--1IuEZ" href="/">Home</a><a class="header-module--navLink--1IuEZ" href="/work">Work</a><a class="header-module--navLink--1IuEZ" href="/3d">3D</a><a class="header-module--navLink--1IuEZ" href="/blog">Blog</a></div><div><h1>Mike Belousov</h1></div></div><hr/></header><main><div class="blog-module--post--oYMJm"><h1>Always use a Monorepo</h1><h3>February 15, 2020</h3><div><p>Always use a monorepo. Because otherwise the temptation to jam more stuff into one package is too strong.
Context switches are annoying, and that may prevent you from correctly crossing package lines when thinking
where to put your code. In my terrible opinion you can always extract the history out to
a separate repo later with <a href="https://github.com/newren/git-filter-repo">git filter-repo</a>.</p>
<p>Anyway, the <em>real</em> reason to use a monorepo is because in tooling environments like HTML5
JavaScript stacks (e.g. create-react-app),
(where monorepo jargon is especially popular) you can expose custom linter rule packages that
bend everyone to your all-knowing will!!!!!! In a work project recently, we had some Sass theming logic
that I deprecated in favor of a more direct, less complicated method for achieving the same thing.
We all wanted a better method and had been looking for a while.
Deprecating it was a great step, but in a large product code base, there's little value and
possible danger in taking a long time to rewrite all of the deprecated references.
The ideal approach is "progressive migration"â€”not wasting time converting everything
that works fine as is, but slowly converting anything that needs maintenance, implying a
sort of LRU chipping away at usage of the deprecated styling technique. Since we were already using
lint-staged+husky to force linting of vcs-staged files precommit, I just added the new
deprecation rule and set it to error, so
other developers could not change style files without first migrating the deprecated references.
It's a tad intense since it still
demands that you migrate any file you may make small changes to, but it ensures active files receive
the love of an easier theming logic so future maintenance is easier.</p>
<p>Without a very proper naming scheme, or private package registry like we have, project-scope
packages are a bit difficult to justify. But, if you're careful, there's a lot of value and change
you can bring about by reading your linters' APIs.</p>
<p>Without a monorepo setup, I'd have had to setup a separate repository and publishing pipeline. Not
a ton of work, but for a utility of exactly project-scope it belongs in your project's source
(vcs) context. I especially opted for this since stylelint only seems to support package-level
custom rules (afaik). I'm sure a module-level custom rule would have been nicer for something
project-only.</p>
<p>JS Monorepos can come with their own headaches, but the scalable reusability is essential.</p></div></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/always_monorepo/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-fd690b0e9cfcd08a5a70.js"],"component---src-components-blog-page-tsx":["/component---src-components-blog-page-tsx-b3a7ffb70a58157fcdfb.js"],"component---src-pages-3-d-tsx":["/component---src-pages-3-d-tsx-6d22607f9782d99bfad2.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-ae7b45a7ba6e5f6968b1.js"],"component---src-pages-blog-tsx":["/component---src-pages-blog-tsx-cccefa4d3cd1085ba47b.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-79b9b249f6b6616ca128.js"],"component---src-pages-sentinel-beam-tsx":["/component---src-pages-sentinel-beam-tsx-8133b2a09ed562db5149.js"],"component---src-pages-work-tsx":["/component---src-pages-work-tsx-c4c87247e73b2adba0c5.js"]};/*]]>*/</script><script src="/webpack-runtime-a185db1d5c95e4b93d98.js" async=""></script><script src="/framework-d18255661b01063664e4.js" async=""></script><script src="/styles-8636a280cbc61d53ad10.js" async=""></script><script src="/922baf5242ed4ba4672941b22c37e341b7a6f945-54cc9b6a670616ae6283.js" async=""></script><script src="/component---src-components-blog-page-tsx-b3a7ffb70a58157fcdfb.js" async=""></script><script src="/app-fd690b0e9cfcd08a5a70.js" async=""></script></body></html>
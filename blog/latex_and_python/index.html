<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.4"/><meta data-react-helmet="true" name="description" content="Mike Belousov&#x27;s Website"/><meta data-react-helmet="true" property="og:title" content="Empowering LaTeX (PyLaTeXc)"/><meta data-react-helmet="true" property="og:description" content="Mike Belousov&#x27;s Website"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Mike Belousov"/><meta data-react-helmet="true" name="twitter:title" content="Empowering LaTeX (PyLaTeXc)"/><meta data-react-helmet="true" name="twitter:description" content="Mike Belousov&#x27;s Website"/><meta name="theme-color" content="#663399"/><style data-href="/styles.f3df89eb0ddcf1501ce9.css" data-identity="gatsby-global-css">._3d-module--container--a12c0{display:flex;flex-wrap:wrap}._3d-module--container--a12c0 img{max-height:200px}.DialogueEditor-module--toolbar--af3ea{box-sizing:border-box;display:flex;gap:22px;height:60px;padding:11px 22px}.DialogueEditor-module--graph--d94d3{height:calc(100vh - 60px)}.DialogueEditor-module--deleteButton--78e43{background-color:red;border:1px solid #000;box-sizing:border-box;color:#fff;cursor:pointer;font-size:16pt;font-weight:500;height:25px;left:calc(100% - 25px);position:absolute;top:0;width:25px}.DialogueEditor-module--dialogueEntryNode--d370e{background-color:#fff;border:1px solid #000;color:#000;padding:22px}.DialogueEditor-module--dialogueEntryNode--d370e>label{align-items:center;display:flex;gap:11px}.DialogueEditor-module--handle--30c88{height:16px;width:16px}.DialogueEditor-module--portraitImage--a639a{height:50px;width:50px}.work-module--container--6017a{overflow:hidden}.work-module--pdf--1900a{width:100%}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media only screen and (max-width:700px){.header-module--pageWrapper--3e268{padding:12px}}@media only screen and (min-width:700px){.header-module--pageWrapper--3e268{padding:22px 1in 1in}}.header-module--topnav--68b35{align-items:center;display:flex;gap:11px}.header-module--navLink--e54d2{transform:scale(1)}.header-module--navLink--e54d2,.header-module--navLink--e54d2:link,.header-module--navLink--e54d2:visited{color:rgb(var(--body-rgb));font-size:1rem;font-weight:700;text-decoration:initial;transition:font-size .1s ease;vertical-align:middle}.header-module--navLink--e54d2:hover{color:orange;transform:scale(1.1)}.header-module--navLink--e54d2:hover>*{fill:orange}.shared-module--center--894dc{align-items:center;display:flex;justify-content:center}@media only screen and (max-width:700px){.layout-module--pageWrapper--b70ac{padding:12px}}@media only screen and (min-width:700px){.layout-module--pageWrapper--b70ac{padding:22px calc(50% - 4.25in) calc(50% - 4.25in)}}body,html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:rgb(var(--background-rgb));color:rgb(var(--body-rgb));font-family:"Noto Serif",serif;font-optical-sizing:auto;font-size:14pt;font-style:normal;font-variation-settings:"wdth" 100;line-height:1.5em;margin:0}h1,h2,h3,h4,h5,h6,header{font-family:Open Sans,sans-serif}code{font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace}a{color:#49a9f9}a:visited{color:#69a9f9}a:active{color:#b9b999}h1{font-size:1.4em;font-weight:700}h1,h3{font-style:italic}h3{font-size:1em;font-weight:400}h1+h3{margin-top:-8px}hr{color:rgba(var(--body-rgb),.3)}.blog-module--container--a5b3b{display:flex;flex-direction:column}@keyframes blog-module--spin--f8bab{0%{transform:scaleX(0)}50%{transform:scaleX(1)}to{transform:scaleX(0)}}.blog-module--loader--8d23c{align-items:center;display:flex;justify-content:center}.blog-module--loader--8d23c .blog-module--inner--d848f{animation-duration:1s;animation-iteration-count:infinite;animation-name:blog-module--spin--f8bab;animation-timing-function:ease-out;border:4px solid rgb(var(--body-rgb));border-radius:50%;height:26px;width:26px}.blog-module--compactBlogListing--64e52{line-height:1.1em}.blog-module--compactBlogListing--64e52>h3{margin-bottom:4px;margin-top:11px}.blog-module--compactBlogListing--64e52>ul{margin-bottom:0;margin-top:0}:root{--background-rgb:18,18,24;--body-rgb:239,239,239}.blog-module--blogLink--6573c{margin:11px}.blog-module--blogLink--6573c,.blog-module--blogLink--6573c:link,.blog-module--blogLink--6573c:visited{color:rgb(var(--body-rgb));font-weight:700;text-decoration:initial;vertical-align:middle}.blog-module--blogLink--6573c:hover{color:orange}.blog-module--blogsSidebar--3e1fa{font-size:.8rem;margin-right:.5in;margin-top:22px;overflow-x:hidden;position:fixed;right:0;top:.8in;width:12rem;z-index:1}@media only screen and (max-width:15in){.blog-module--blogsSidebar--3e1fa{display:none}}</style><title data-react-helmet="true">Empowering LaTeX (PyLaTeXc) | Mike Belousov&#x27;s Website</title><link data-react-helmet="true" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/paraiso-dark.min.css" crossorigin="anonymous"/><link rel="icon" href="/favicon-32x32.png?v=2405b308f5bfa6bed1da04996c2e3d55" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=2405b308f5bfa6bed1da04996c2e3d55"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=2405b308f5bfa6bed1da04996c2e3d55"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=2405b308f5bfa6bed1da04996c2e3d55"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=2405b308f5bfa6bed1da04996c2e3d55"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=2405b308f5bfa6bed1da04996c2e3d55"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=2405b308f5bfa6bed1da04996c2e3d55"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=2405b308f5bfa6bed1da04996c2e3d55"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=2405b308f5bfa6bed1da04996c2e3d55"/><link rel="alternate" type="application/rss+xml" title="Mike Belousov&#x27;s blog" href="/rss.xml"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="true"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&amp;display=swap"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,100..900;1,100..900&amp;display=swap"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-module--pageWrapper--b70ac"><header><div class="shared-module--center--894dc"><nav class="header-module--topnav--68b35">Mike Belousov<a class="header-module--navLink--e54d2" href="/">Home</a><a class="header-module--navLink--e54d2" href="/work/">Resume</a><a class="header-module--navLink--e54d2" href="/3d/">Art</a><a class="header-module--navLink--e54d2" href="/blog/">Blog</a><a href="https://github.com/MichaelBelousov" class="shared-module--center--894dc"><svg class="header-module--navLink--e54d2" style="width:20px;height:20px;margin-top:4px" viewBox="0 0 100 100" width="98" height="96"><path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0112.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="#fff"></path></svg></a></nav></div><hr/><br/></header><main><nav class="blog-module--blogsSidebar--3e1fa"><h2>Other posts</h2><div class="blog-module--compactBlogListing--64e52"><h3><strong>2022</strong></h3><div><div><a href="/blog/bashisms/" class="blog-module--blogLink--6573c" style="margin:0">Bashisms Part 1</a></div></div></div><div class="blog-module--compactBlogListing--64e52"><h3><strong>2021</strong></h3><div><div><a href="/blog/subclass-apis-in-react/" class="blog-module--blogLink--6573c" style="margin:0">The useClass hook and using class-based APIs in modern React</a></div></div></div><div class="blog-module--compactBlogListing--64e52"><h3><strong>2020</strong></h3><div><div><a href="/blog/iterators-and-generators-are-better-than-array-prototype/" class="blog-module--blogLink--6573c" style="margin:0">Lazy Javascript Iterables via Generators</a></div><div><a href="/blog/imodeljs-articles-oct-2020/" class="blog-module--blogLink--6573c" style="margin:0">iModel.js Articles</a></div><div><a href="/blog/react_hooks_tutorial/" class="blog-module--blogLink--6573c" style="margin:0">React and its hooks without Create React App</a></div><div><a href="/blog/always_monorepo/" class="blog-module--blogLink--6573c" style="margin:0">Always use a Monorepo</a></div></div></div><div class="blog-module--compactBlogListing--64e52"><h3><strong>2019</strong></h3><div><div><a href="/blog/eye_ball/" class="blog-module--blogLink--6573c" style="margin:0">Eye Progress</a></div><div><a href="/blog/blender_2_8/" class="blog-module--blogLink--6573c" style="margin:0">Blender 2.8 Grease Pencil Is Awesome</a></div><div><a href="/blog/convex_hull/" class="blog-module--blogLink--6573c" style="margin:0">Melkman Algorithm Visualization</a></div><div><a href="/blog/latex_and_python/" class="blog-module--blogLink--6573c" style="margin:0">Empowering LaTeX (PyLaTeXc)</a></div></div></div><div class="blog-module--compactBlogListing--64e52"><h3><strong>2018</strong></h3><div><div><a href="/blog/billwurtz/" class="blog-module--blogLink--6573c" style="margin:0">Bill Wurtz</a></div><div><a href="/blog/Super_Thin_RAII_Wrappers_for_C_Types/" class="blog-module--blogLink--6573c" style="margin:0">Super Thin RAII Wrappers for C Types</a></div></div></div></nav><div><h1>Empowering LaTeX (PyLaTeXc)</h1><h3>May 4, 2019</h3><div><p>The one nagging gap in my homework development stack early on
was an itch for
programmability, that trait which Excel is alleged to have.
But I have a gripe with Excel. It's like Scratch for adults,
A psuedoscripting language for the uninitiated and unlearned.
Personally, I've always kicked up a Python interpreter any
time I needed a calculation, and I quickly began depending on
Python+scipy for more intense derivations and data routines. I scratched
up a utility module for producing LaT<sub>E</sub>X tables and pgfplots graphics
from various data formats, and used it frequently with minimal
copy and paste glue (thank you Cygwin's
<code class="language-latex">/dev/clipboard</code>).</p>
<p>But larger projects begged for more complete tools; like that assignment
involving the visualization
of 26 different samples from a dataset, as well as calculating some
statistical metrics about each sample.
A sane person would have used the charting features
in the Excel spreadsheet it was provided in, but that's outside the scope
of this post.
I exported to csv immediately and made an incredibly primitive
toolkit for embedding Python logic in LaT<sub>E</sub>X. Revisiting it a
couple of months later, I refined my toolkit massively and today I
would consider the design complete, but alternative implementation
approaches merit some exploration.</p>
<p>The first time I attemped glueing my Pythonisms into LaT<sub>E</sub>X,
my design was a tiny mapping from a LaT<sub>E</sub>X grammar extension
to Python formatting key syntax.
If I were to write my LaT<sub>E</sub>X code directly in a Python string,
and attempt to use formatting keys,
I would probably spontaneously combust. It looks like this:</p>
<div class="gatsby-highlight" data-language="latex"><pre class="language-latex"><code class="language-latex">r"""<span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">{document</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token function selector">\frac</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>kill<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>me<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">{document</span><span class="token punctuation">}</span><span class="token punctuation">}</span>""".format(kill=5, me=10)</code></pre></div>
<p>That's almost as crufty as chained ternary expressions in JSX.
Backslash doubling I can avoid by making it a raw string, but that
isn't an option in all use cases.
Regardless, I hid this formatting ugliness behind a script, which
escaped braces for me, and interpretted the characters '&#x3C;&#x3C;' as '{', and
'>>' as '}'. So now I didn't have to brace every 5 characters, and the
keys looked distinct from the LaT<sub>E</sub>X syntax.
My dumb and ugly LaT<sub>E</sub>X superset templater took about 5 lines of
Python code to process, and the source looked like:</p>
<div class="gatsby-highlight" data-language="latex"><pre class="language-latex"><code class="language-latex"><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span>
<span class="token function selector">\frac</span><span class="token punctuation">{</span>&lt;&lt;numerator>><span class="token punctuation">}</span><span class="token punctuation">{</span>&lt;&lt;denominator>><span class="token punctuation">}</span>
<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span></code></pre></div>
<p>Quite literally, all my template processor had to do was replace all braces with
escaped double braces, and then replace all
double angle brackets with a single formatting brace, thus yielding
the valid Python formatting keys, while allowing raw LaT<sub>E</sub>X to look
at least familiar.
Then you just produce your values and/or data in your Python script,
read this template from some file,
and submit it to Python's formatting functinos with the expected keyword
arguments that you used in the document source
(e.g. &#x3C;<numerator>>).
Here's the naive templating implementation:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">load_pytex</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
  txt <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
  txt <span class="token operator">=</span> txt<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'{'</span><span class="token punctuation">,</span><span class="token string">'{{'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'}'</span><span class="token punctuation">,</span><span class="token string">'}}'</span><span class="token punctuation">)</span>    
  txt <span class="token operator">=</span> txt<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&lt;&lt;'</span><span class="token punctuation">,</span> <span class="token string">'{'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'>>'</span><span class="token punctuation">,</span> <span class="token string">'}'</span><span class="token punctuation">)</span>
  txt<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
  <span class="token keyword">return</span> txt  <span class="token comment"># or subproc.check_output(['pdflatex' ...])</span></code></pre></div>
<p>So this works, but it would be quite annoying to have a Python
context so decoupled from the usage context. Calculating things
without regard to the location in the document, and being
unable to change the logic while editing the document without
switching files.
Certainly I could do better? So I did something sinful.</p>
<p>Fake macros in LaT<sub>E</sub>X will make this all look way more T<sub>E</sub>X-savvy.
Let's add a <code class="language-latex"><span class="token function selector">\pyeval</span></code> pseudo-command, and a
<code class="language-text">pyexec</code> pseudo-environment so that we can get something
like so:</p>
<div class="gatsby-highlight" data-language="latex"><pre class="language-latex"><code class="language-latex"><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">pyexec</span><span class="token punctuation">}</span>
name = 'John'
<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">pyexec</span><span class="token punctuation">}</span>

Hello I am <span class="token function selector">\pyeval</span><span class="token punctuation">{</span>' '.join(<span class="token punctuation">[</span>name,'Smith'<span class="token punctuation">]</span>)<span class="token punctuation">}</span></code></pre></div>
<p>Originally I implemented (knowing my transgressions) a naive
regular expression based implementation, but this has many problems</p>
<ul>
<li>I want to ignore false ends in quotes and comments</li>
<li>I want to allow counting of nested braces in pyeval</li>
</ul>
<p>expressions so that you don't need to escape all right
braces. (Regular expressions can't find the valid ending
brace of a nested expression)
Checkout the following counter_examples:</p>
<div class="gatsby-highlight" data-language="latex"><pre class="language-latex"><code class="language-latex"><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">pyexec</span><span class="token punctuation">}</span>
hate_you = r'<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">pyexec</span><span class="token punctuation">}</span>'  # we need to avoid ending if its in a literal
<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">pyexec</span><span class="token punctuation">}</span>

<span class="token function selector">\pyeval</span><span class="token punctuation">{</span>h = <span class="token punctuation">{</span>'hello': 'world', 'x': <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>  # which brace do we end on?</code></pre></div>
<p>So I couldn't use regular expressions for this, but I still wanted it.
Because my LaT<sub>E</sub>X document source would look like this:</p>
<div class="gatsby-highlight" data-language="latex"><pre class="language-latex"><code class="language-latex"><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">pyexec</span><span class="token punctuation">}</span>
from scipy.optimize import curve_fit
from random import random as rand
from itertools import count, product as crossproduct
bin = crossproduct((0,1),repeat=5)
data = list(zip(count(), bin))
# add a count of set bits as a column
for row in data:
d, b = row
row.append(b.count(1))
randpts = <span class="token punctuation">[</span><span class="token punctuation">[</span>rand(),rand()<span class="token punctuation">]</span> for _ in range(100)<span class="token punctuation">]</span>
<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">pyexec</span><span class="token punctuation">}</span>

<span class="token function selector">\section*</span><span class="token punctuation">{</span><span class="token headline class-name">Data Stuff</span><span class="token punctuation">}</span>

<span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">tabular</span><span class="token punctuation">}</span><span class="token punctuation">{</span>|c|c|<span class="token punctuation">}</span>
<span class="token function selector">\hline</span>
Decimal <span class="token punctuation">&amp;</span> Binary <span class="token punctuation">&amp;</span> 1-Bits <span class="token function selector">\\</span>
<span class="token function selector">\hline</span>
<span class="token function selector">\pyeval</span><span class="token punctuation">{</span>'<span class="token function selector">\n</span>'.join(('<span class="token punctuation">&amp;</span>'.join(map(str,d)) for d in data))<span class="token punctuation">}</span>
<span class="token comment">% we can extract the above one-liner for reuse in tabular </span>
<span class="token comment">% construction and any horizontally partitioned context</span>
<span class="token function selector">\hline</span>
<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">tabular</span><span class="token punctuation">}</span>

<span class="token comment">% use unpack+zip hack to get separate lists of x then y coords</span>
Best Fit: <span class="token function selector">\pyeval</span><span class="token punctuation">{</span>curve_fit(lambda x,m,b: m*x+b, zip(*randpts))<span class="token punctuation">}</span> </code></pre></div>
<p>Mmmmm... delicious. It looks so much like Python yet so much like LaT<sub>E</sub>X.
It's both at once, without crippling either one! It's logic embedded in the document
markup cleanly. So I did go and implement it. Originally I tried using a more
complicated parsing approach, PyParsing, but it turned out to be far too complicated
for what was essentially templating. I ended up settling on parsing by character, due
to the simplicity of the extension. There are a few performance enhancements I could
make but I'm not in the need of them right now, and I've noted them for posterity in
my README. This is PyLaT<sub>E</sub>X, and I put it on my
<a href="https://github.com/MichaelBelousov/pylatexc">GitHub</a></p>
<p>At last, I would argue, that we have a tool more extensible than Excel,
it's got all of PyPI behind it, with numpy, scipy, and all the packages
you could wantâ€” embedded in your document.
If you like this approach, maybe you can be just as sinful and throw it into
Markdown, or change up the scripting language to your preference. So long as you
don't use php. Even if it's already a templating language.</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown"><span class="token title important">My Document
<span class="token punctuation">===========</span></span>

<span class="token code"><span class="token punctuation">```</span><span class="token code-language">pyexec</span>
<span class="token code-block language-pyexec">import csv
data = list(csv.reader('mycsv.csv'))</span>
<span class="token punctuation">```</span></span>
<span class="token code-snippet code keyword">`>>> '\n'.join(data)`</span></code></pre></div>
<p>And as a final note, check out <a href="https://typora.io/">Typora</a>
other cool ways to not use Office products. I don't actually use it, but the LaT<sub>E</sub>X
in Markdown makes me want to. Even if I'm not in school any more.</p>
<style>
span.vim {
    font-size: 3pt;
}
</style></div></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/latex_and_python/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-1e1ffb37da17e5994d93.js\"],\"component---src-components-blog-page-tsx\":[\"/component---src-components-blog-page-tsx-31a999cdb14eb9e306bf.js\"],\"component---src-pages-3-d-tsx\":[\"/component---src-pages-3-d-tsx-7b09ad6e7bf02fa4283f.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-9e301ddcb18e9b12967c.js\"],\"component---src-pages-blog-tsx\":[\"/component---src-pages-blog-tsx-17becfa763da4057e51c.js\"],\"component---src-pages-dialogue-editor-tsx\":[\"/component---src-pages-dialogue-editor-tsx-faf842d1ade65eca7944.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-413e3734bbfffa53bee7.js\"],\"component---src-pages-sentinel-beam-tsx\":[\"/component---src-pages-sentinel-beam-tsx-329d36533826d9421376.js\"],\"component---src-pages-work-tsx\":[\"/component---src-pages-work-tsx-410031f4548ddaa9def6.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="1611c354ac8a7bd95c90";</script><script src="/webpack-runtime-d99a7dca92ad8807c6e4.js" async></script><script src="/app-1e1ffb37da17e5994d93.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>